# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

## üìë –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û–±–∑–æ—Ä](#overview)
- [–ö–æ–Ω—Ü–µ–ø—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã](#architecture-concept)
- [–í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#high-level-architecture)
- [–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤](#process-separation)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#security-architecture)
- [–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö](#data-flow)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](#database-architecture)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤](#component-architecture)
- [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ API](#external-api-integration)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–±–æ—Ä–∫–∏](#build-architecture)
- [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ State](#state-management)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤](#file-structure)
- [–ü—Ä–∏–Ω—Ü–∏–ø—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](#design-principles)
- [–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å](#current-status)

---

## –û–±–∑–æ—Ä

–≠—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–ª–µ–¥—É–µ—Ç —Å—Ç—Ä–æ–≥–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ **–†–∞–∑–¥–µ–ª–µ–Ω–∏—è –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–µ–π (Separation of Concerns, SoC)**, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—è –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É Electron Main Process (–±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å—Ä–µ–¥–∞ Node.js) –∏ Renderer Process (–∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ä–µ–¥–∞ –±—Ä–∞—É–∑–µ—Ä–∞).

üìñ **–°–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ API](./api.md) - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–æ IPC API
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö](./database.md) - –î–µ—Ç–∞–ª–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ](./development.md) - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
- [–ì–ª–æ—Å—Å–∞—Ä–∏–π](./glossary.md) - –ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ä–º–∏–Ω—ã (Main Process, Renderer Process, IPC –∏ —Ç.–¥.)

### –°—Ö–µ–º–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–ü—Ä–∏–≤–µ–¥–µ–Ω–Ω–∞—è –Ω–∏–∂–µ —Å—Ö–µ–º–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É. **–ü—Ä–æ—á—Ç–∏—Ç–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø–æ–¥ —Å—Ö–µ–º–æ–π** –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è.

```mermaid
graph TB
    subgraph "Renderer Process (Browser)"
        ReactContext[React Context<br/>Components & State]
        TanStackQuery[TanStack Query<br/>Data Fetching]
        Zustand[Zustand Store<br/>UI State]
    end

    subgraph "IPC Bridge"
        Preload[preload.ts<br/>Context Bridge]
        IPCHandlers[IPC Handlers<br/>Validation & Routing]
    end

    subgraph "Main Process (Node.js)"
        ServicesLayer[Services Layer<br/>Business Logic]
        BackendClients[Backend Clients<br/>API Communication]
    end

    subgraph "Main Process Database"
        DrizzleORM[Drizzle ORM<br/>Type-Safe Queries]
        SQLiteDB[(SQLite Database<br/>WAL Mode)]
    end

    subgraph "External"
        Rule34API[Rule34.xxx API<br/>External Service]
        SQLiteDB[(SQLite Database<br/>Local Storage)]
    end

    ReactContext <--> Preload
    TanStackQuery <--> Preload
    Zustand --> ReactContext
    Preload <--> IPCHandlers
    IPCHandlers --> ServicesLayer
    ServicesLayer --> BackendClients
    ServicesLayer --> DrizzleORM
    DrizzleORM --> SQLiteDB
    BackendClients --> Rule34API

    style ReactContext fill:#e1f5ff
    style Preload fill:#fff4e1
    style ServicesLayer fill:#ffe1e1
    style DrizzleORM fill:#f0e1ff
    style SQLiteDB fill:#e1ffe1
    style Rule34API fill:#ffe1f5
```

**–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —ç—Ç–∞ —Å—Ö–µ–º–∞:**

RuleDesk –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ Electron, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç –¥–≤–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞:

1.  **Renderer Process (–ë—Ä–∞—É–∑–µ—Ä)** - –ó–¥–µ—Å—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–∞—à React UI. –≠—Ç–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ä–µ–¥–∞ –±—Ä–∞—É–∑–µ—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –º–æ–∂–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ Node.js API –∏–ª–∏ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ. –û–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
    -   **React Context** –¥–ª—è Component State –∏ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    -   **TanStack Query** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ Main Process —á–µ—Ä–µ–∑ IPC
    -   **Zustand** –¥–ª—è –ª–µ–≥–∫–æ–≤–µ—Å–Ω–æ–≥–æ UI State (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∫–æ–µ –¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã—Ç–æ)

2.  **IPC Bridge** - –≠—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–ª–æ–π —Å–≤—è–∑–∏ –º–µ–∂–¥—É Renderer –∏ Main Process:
    -   **–°–∫—Ä–∏–ø—Ç Preload** (`preload.ts`) –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–π API (`window.api`) –¥–ª—è Renderer
    -   **IPC Handlers** –≤ Main Process –ø—Ä–æ–≤–µ—Ä—è—é—Ç –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É—é—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Å–µ—Ä–≤–∏—Å–∞–º

3.  **Main Process (Node.js)** - –≠—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –±—ç–∫–µ–Ω–¥, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:
    -   **Services Layer** - –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, —Ñ–∞–π–ª–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)
    -   **Backend Clients** - –°–≤—è–∑—å —Å –≤–Ω–µ—à–Ω–∏–º–∏ API (Rule34.xxx, Gelbooru)

4.  **Database** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite, –∫ –∫–æ—Ç–æ—Ä–æ–π –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –≤ Main Process:
    -   **Drizzle ORM** –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
    -   **SQLite** —Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ª–æ–∫–∞–ª—å–Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–µ–∂–∏–º–∞ WAL –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ü—Ä–∏–º–µ—Ä –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**

–ö–æ–≥–¥–∞ –≤—ã –Ω–∞–∂–∏–º–∞–µ—Ç–µ "Add Artist" –≤ UI:
1.  React Component –≤—ã–∑—ã–≤–∞–µ—Ç `window.api.addArtist(data)`
2.  –°–∫—Ä–∏–ø—Ç Preload –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –≤ Main Process —á–µ—Ä–µ–∑ IPC
3.  IPC Handler –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∏—Å–ø–æ–ª—å–∑—É—è Zod-—Å—Ö–µ–º—ã
4.  Service Layer —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç Artist –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Drizzle ORM
5.  –û—Ç–≤–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ IPC –≤ Renderer
6.  React Query –æ–±–Ω–æ–≤–ª—è–µ—Ç UI –Ω–æ–≤—ã–º Artist'–æ–º

–¢–∞–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (Renderer –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º) –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ Main Process).

## –ö–æ–Ω—Ü–µ–ø—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 1. –î–≤—É—Ö–º–æ–¥—É–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

-   **–†–µ–∂–∏–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (Library Mode):** –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö SQLite. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è.
-   **–†–µ–∂–∏–º –±—Ä–∞—É–∑–µ—Ä–∞ (Browser Mode):** –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å `<webview>`. –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ (Source) –Ω–∞—Ç–∏–≤–Ω–æ. "–ú–æ—Å—Ç" –º–µ–∂–¥—É —Å–∞–π—Ç–æ–º –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —á–µ—Ä–µ–∑ –∏–Ω—ä–µ–∫—Ü–∏—é —Å–∫—Ä–∏–ø—Ç–æ–≤ (DOM scraping + IPC triggers).

### 2. –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (–∑–∞–¥–µ–ª –Ω–∞ –±—É–¥—É—â–µ–µ)

-   –í –±—É–¥—É—â–µ–º `SyncService` –±–æ–ª—å—à–µ –Ω–µ –±—É–¥–µ—Ç —Ç–µ—Å–Ω–æ —Å–≤—è–∑–∞–Ω —Å Rule34.
-   –í–≤–æ–¥–∏—Ç—Å—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `BooruProvider` (–º–µ—Ç–æ–¥—ã: `getPosts`, `getArtistInfo`, `search`).
-   –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞–Ω–µ—Ç `Rule34Provider`. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –±–µ–∑ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

## –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

```mermaid
graph TB
    subgraph "Electron Application"
        subgraph "Renderer Process (Browser)"
            ReactUI[React UI Components]
            Zustand[Zustand Store]
            ReactQuery[TanStack Query]
        end

        subgraph "IPC Bridge"
            Preload[preload.ts]
            IPC[IPC Handlers]
        end

        subgraph "Main Process (Node.js)"
            Services[Services Layer]
            BackendClients[Backend Clients]
        end

        subgraph "Main Process Database"
            Drizzle[Drizzle ORM]
            SQLite[(SQLite)]
        end
    end

    subgraph "External"
        Rule34API[Rule34.xxx API]
        SQLite[(SQLite Database)]
    end

    ReactUI <--> Preload
    Preload <--> IPC
    IPC --> Services
    Services --> BackendClients
    Services --> Drizzle
    Drizzle --> SQLite
    BackendClients --> Rule34API

    ReactUI --> Zustand
    ReactUI --> ReactQuery
    ReactQuery --> Preload
```

### –ü–æ—Ç–æ–∫ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

–°—Ö–µ–º–∞ –Ω–∏–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É. **–ü—Ä–æ—á—Ç–∏—Ç–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –Ω–∏–∂–µ** –¥–ª—è –ø–æ—à–∞–≥–æ–≤–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è.

```mermaid
sequenceDiagram
    participant User
    participant ReactUI as React UI
    participant Bridge as IPC Bridge
    participant Controller as IPC Controller
    participant DI as DI Container
    participant Service as Services
    participant DB as SQLite (Drizzle)
    participant API as Rule34 API

    User->>ReactUI: User Action
    ReactUI->>Bridge: window.api.method()
    Bridge->>Controller: ipcRenderer.invoke()
    Controller->>Controller: Validate Input (Zod)
    Controller->>DI: Resolve Dependencies
    DI-->>Controller: Service Instances
    Controller->>Service: Call Service Method
    Service->>DB: Execute Query (Drizzle)
    DB-->>Service: Return Data
    Service-->>Controller: Return Response
    Controller-->>Bridge: IPC Response
    Bridge-->>ReactUI: Promise Resolve
    ReactUI->>User: Update UI
```

**–ü–æ—à–∞–≥–æ–≤–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Å–ª–µ–¥–∏–º, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "Add Artist":

1.  **–î–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É –∏ –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "Add Artist"

2.  **React UI** - React Component –≤—ã–∑—ã–≤–∞–µ—Ç `window.api.addArtist(artistData)`. –≠—Ç–æ Promise, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏.

3.  **IPC Bridge** - –°–∫—Ä–∏–ø—Ç Preload (`preload.ts`) –ø–æ–ª—É—á–∞–µ—Ç –≤—ã–∑–æ–≤ –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ Main Process, –∏—Å–ø–æ–ª—å–∑—É—è `ipcRenderer.invoke('db:add-artist', artistData)`. –≠—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π IPC-–º–µ—Ö–∞–Ω–∏–∑–º Electron.

4.  **IPC Controller** - –í Main Process `ArtistsController` –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å. –ü—Ä–µ–∂–¥–µ —á–µ–º —á—Ç–æ-–ª–∏–±–æ –¥–µ–ª–∞—Ç—å, –æ–Ω:
    -   **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**, –∏—Å–ø–æ–ª—å–∑—É—è Zod-—Å—Ö–µ–º—É (–≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ `name` –∏ `tag` —è–≤–ª—è—é—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏, –∞ `apiEndpoint` ‚Äî –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º URL)
    -   –ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å, –æ–Ω –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ Renderer

5.  **–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (Dependency Injection)** - –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—É –Ω—É–∂–Ω—ã —Å–µ—Ä–≤–∏—Å—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö). –û–Ω –ø—Ä–æ—Å–∏—Ç DI Container —Ä–∞–∑—Ä–µ—à–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç singleton-—ç–∫–∑–µ–º–ø–ª—è—Ä—ã —Å–µ—Ä–≤–∏—Å–æ–≤.

6.  **Service Layer** - –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –≤—ã–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥ —Å–µ—Ä–≤–∏—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `dbService.addArtist()`). –°–µ—Ä–≤–∏—Å—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É.

7.  **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - –°–µ—Ä–≤–∏—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Drizzle ORM –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞: `db.insert(artists).values(artistData)`. SQLite —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ.

8.  **–ü–æ—Ç–æ–∫ –æ—Ç–≤–µ—Ç–∞** - –î–∞–Ω–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è:
    -   –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π Artist (—Å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º ID)
    -   –°–µ—Ä–≤–∏—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç Artist
    -   –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ —á–µ—Ä–µ–∑ IPC
    -   Bridge —Ä–∞–∑—Ä–µ—à–∞–µ—Ç Promise –≤ Renderer
    -   React Query –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫—ç—à –∏ UI

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**

–ï—Å–ª–∏ –∫–∞–∫–æ–π-–ª–∏–±–æ —à–∞–≥ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –Ω–µ—É–¥–∞—á–µ–π (–æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –æ—à–∏–±–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, —Å–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞), –æ—à–∏–±–∫–∞ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è `BaseController`, –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è, –∏ —É–¥–æ–±–Ω–æ–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ Renderer. UI –∑–∞—Ç–µ–º –º–æ–∂–µ—Ç –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ.

**–ü–æ—á–µ–º—É —ç—Ç–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞?**

-   **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** Renderer –Ω–µ –º–æ–∂–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
-   **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** TypeScript –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ç–∏–ø–æ–≤ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ
-   **–í–∞–ª–∏–¥–∞—Ü–∏—è:** Zod-—Å—Ö–µ–º—ã –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ –æ–Ω–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç —Å–µ—Ä–≤–∏—Å–æ–≤
-   **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–µ–π:** –ö–∞–∂–¥—ã–π —Å–ª–æ–π –∏–º–µ–µ—Ç –æ–¥–Ω—É –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
-   **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å:** –ö–∞–∂–¥—ã–π —Å–ª–æ–π –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–°—Ö–µ–º–∞ –Ω–∏–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö. **–ü—Ä–æ—á—Ç–∏—Ç–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ** –¥–ª—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è.

```mermaid
graph LR
    subgraph "Main Process"
        Main[Main Process]
        Services[Services]
        DrizzleORM[Drizzle ORM]
        SQLiteDB[(SQLite<br/>WAL Mode)]
    end

    Main -->|Direct Call| Services
    Services -->|Query| DrizzleORM
    DrizzleORM -->|SQL| SQLiteDB
    SQLiteDB -->|Result| DrizzleORM
    DrizzleORM -->|Data| Services
    Services -->|Return| Main
```

**–ß—Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ:**

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç **–Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ Main Process** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞. –í–æ—Ç –∫–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1.  **–°–µ—Ä–≤–∏—Å—ã –≤—ã–∑—ã–≤–∞—é—Ç Drizzle ORM** - –ö–æ–≥–¥–∞ —Å–µ—Ä–≤–∏—Å—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª—å –∑–∞–ø—Ä–æ—Å–æ–≤ Drizzle:
    ```typescript
    const artists = await db.query.artists.findMany({
      orderBy: [asc(artists.name)],
    });
    ```

2.  **Drizzle –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç SQL** - Drizzle ORM –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∑–∞–ø—Ä–æ—Å TypeScript –≤ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π SQL:
    ```sql
    SELECT * FROM artists ORDER BY name ASC;
    ```

3.  **SQLite –≤—ã–ø–æ–ª–Ω—è–µ—Ç** - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite (—á–µ—Ä–µ–∑ `better-sqlite3`) –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å **—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ**.

    **‚ö†Ô∏è –í–ê–ñ–ù–û: –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç Main Process**

    `better-sqlite3` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ** –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:
    -   ‚úÖ **–ë—ã—Å—Ç—Ä–æ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤** - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å, –ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π
    -   ‚ö†Ô∏è **–ë–ª–æ–∫–∏—Ä—É–µ—Ç Main Process** - –¢—è–∂–µ–ª—ã–µ –∑–∞–ø—Ä–æ—Å—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –±–µ–∑ –∏–Ω–¥–µ–∫—Å–æ–≤) **–∑–∞–º–æ—Ä–æ–∑—è—Ç –≤—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Electron**
    -   ‚ö†Ô∏è **UI –∑–∞–≤–∏—Å–∞–µ—Ç** - –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –∑–∞–Ω–∏–º–∞–µ—Ç 2 —Å–µ–∫—É–Ω–¥—ã, UI –∑–∞–≤–∏—Å–∞–µ—Ç –Ω–∞ 2 —Å–µ–∫—É–Ω–¥—ã

    **–ü–æ—á–µ–º—É —ç—Ç–æ –±—ã—Å—Ç—Ä–æ –¥–ª—è —Ç–∏–ø–∏—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:**
    -   –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–µ—Ç–µ–≤—ã—Ö –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ (–ª–æ–∫–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
    -   –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (–±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫ async/await)
    -   –†–µ–∂–∏–º WAL –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —á—Ç–µ–Ω–∏—è –≤–æ –≤—Ä–µ–º—è –∑–∞–ø–∏—Å–∏
    -   **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã** –¥–µ–ª–∞—é—Ç –∑–∞–ø—Ä–æ—Å—ã –±—ã—Å—Ç—Ä—ã–º–∏ (–º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã, –∞ –Ω–µ —Å–µ–∫—É–Ω–¥—ã)

    **‚ö†Ô∏è –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û: –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Limits –∏ Indexes**

    –ß—Ç–æ–±—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É Main Process:
    -   **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `limit`** –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö SELECT (—Å–º. [–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](#-critical-always-use-limits-for-select-queries))
    -   **–£–±–µ–¥–∏—Ç–µ—Å—å –≤ –Ω–∞–ª–∏—á–∏–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö Indexes** –¥–ª—è WHERE-—É—Å–ª–æ–≤–∏–π
    -   **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞–≥–∏–Ω–∞—Ü–∏—é** –¥–ª—è –±–æ–ª—å—à–∏—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö
    -   **–ò–∑–±–µ–≥–∞–π—Ç–µ –ø–æ–ª–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã** - –í—Å–µ–≥–¥–∞ —Ñ–∏–ª—å—Ç—Ä—É–π—Ç–µ –ø–æ –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Å—Ç–æ–ª–±—Ü–∞–º

    **–ü—Ä–∏–º–µ—Ä –æ–ø–∞—Å–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:**

    ```typescript
    // ‚ùå DANGEROUS: No limit, no index on tags column
    // If database has 100k posts, this will freeze UI for seconds
    const posts = await db.query.posts.findMany({
      where: like(posts.tags, "%some_tag%"), // Full table scan!
      // Missing limit!
    });
    ```

    **–ü—Ä–∏–º–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:**

    ```typescript
    // ‚úÖ SAFE: Uses indexed column and limit
    const posts = await db.query.posts.findMany({
      where: eq(posts.artistId, artistId), // Indexed column
      orderBy: [desc(posts.postId)],
      limit: 50, // ‚Üê Prevents large result sets
      offset: (page - 1) * 50,
    });
    ```

4.  **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è** - SQLite –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Üí Drizzle —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏—Ö —Å —Ç–∏–ø–∞–º–∏ TypeScript ‚Üí –°–µ—Ä–≤–∏—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã

**–ü–æ—á–µ–º—É —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø?**

-   **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö (–¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)
-   **–ü—Ä–æ—Å—Ç–æ—Ç–∞:** –ü—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ü–µ–ø–æ—á–µ–∫ Promise
-   **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** Drizzle –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–∏–ø–æ–≤ TypeScript —Å—Ö–µ–º–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
-   **WAL Mode:** Write-Ahead Logging –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —á—Ç–µ–Ω–∏—è –¥–∞–∂–µ –≤–æ –≤—Ä–µ–º—è –∑–∞–ø–∏—Å–∏

**‚ö†Ô∏è –†–µ–∂–∏–º WAL –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω**

SQLite –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –≤ **—Ä–µ–∂–∏–º–µ WAL (Write-Ahead Logging)**, —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å:
-   **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —á—Ç–µ–Ω–∏—è** –≤–æ –≤—Ä–µ–º—è –∑–∞–ø–∏—Å–∏
-   **–õ—É—á—à—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –¥–ª—è —Ä–∞–±–æ—á–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫ —Å –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–º —á—Ç–µ–Ω–∏–µ–º
-   **–ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–µ —á—Ç–µ–Ω–∏—è** –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏

–†–µ–∂–∏–º WAL –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ `src/main/db/client.ts`:

```typescript
// WAL mode is enabled automatically
sqlite.pragma("journal_mode = WAL");
```

**–ë–µ–∑ —Ä–µ–∂–∏–º–∞ WAL:**
-   –ó–∞–ø–∏—Å—å –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Å–µ —á—Ç–µ–Ω–∏—è
-   –û—à–∏–±–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º –¥–æ—Å—Ç—É–ø–µ
-   –ù–∏–∑–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —á–∏—Ç–∞—Ç–µ–ª—è–º–∏

**–ü—Ä–∏–º–µ—Ä: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ Artist**

```typescript
// In ArtistsController
const db = container.resolve(DI_TOKENS.DB);

// Drizzle query (type-safe)
const result = await db
  .insert(artists)
  .values({
    name: "artist_name",
    tag: "tag_name",
    type: "tag",
    apiEndpoint: "https://api.rule34.xxx",
  })
  .returning();

// result[0] is typed as Artist
return result[0];
```

**‚ö†Ô∏è –í–ê–ñ–ù–û: –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Limits –¥–ª—è SELECT-–∑–∞–ø—Ä–æ—Å–æ–≤**

**–ü–æ—á–µ–º—É Limits –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã:**

–ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –ø–æ—Å—Ç–æ–≤ –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –±–æ–ª—å—à–∏–º–∏, **–≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `limit`** –≤ –≤–∞—à–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö Drizzle. –ë–µ–∑ Limits, SQLite –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –¥–µ—Å—è—Ç–∫–∏ –∏–ª–∏ —Å–æ—Ç–Ω–∏ —Ç—ã—Å—è—á –∑–∞–ø–∏—Å–µ–π, —á—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫:

1.  **–ü–µ—Ä–µ–≥—Ä—É–∑–∫–µ Renderer Process** - –ü–æ–ø—ã—Ç–∫–∞ —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –±–æ–ª–µ–µ 100 —Ç—ã—Å—è—á –∑–∞–ø–∏—Å–µ–π —á–µ—Ä–µ–∑ IPC –∑–∞–º–æ—Ä–æ–∑–∏—Ç UI
2.  **–ò—Å—á–µ—Ä–ø–∞–Ω–∏—é –ø–∞–º—è—Ç–∏** - –ë–æ–ª—å—à–∏–µ –º–∞—Å—Å–∏–≤—ã –ø–æ—Ç—Ä–µ–±–ª—è—é—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –æ–±—ä–µ–º –ø–∞–º—è—Ç–∏ –∫–∞–∫ –≤ Main, —Ç–∞–∫ –∏ –≤ Renderer Process
3.  **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–µ IPC Channel** - –ë–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã –¥–∞–Ω–Ω—ã—Ö –±–ª–æ–∫–∏—Ä—É—é—Ç IPC Channel, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –¥—Ä—É–≥–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

**–ü—Ä–∏–º–µ—Ä: –ó–∞–ø—Ä–æ—Å –ø–æ—Å—Ç–æ–≤ —Å Limit**

```typescript
// ‚úÖ CORRECT: Always use limit
const posts = await db.query.posts.findMany({
  where: eq(posts.artistId, artistId),
  orderBy: [desc(posts.postId)],
  limit: 50, // ‚Üê CRITICAL: Always limit results
  offset: (page - 1) * 50,
});

// ‚ùå WRONG: No limit - will crash with large databases
const posts = await db.query.posts.findMany({
  where: eq(posts.artistId, artistId),
  // Missing limit - dangerous!
});
```

**–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏:**

-   **Limit –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** 50 –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `getArtistPosts`)
-   **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π limit:** –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–π—Ç–µ 1000 –∑–∞–ø–∏—Å–µ–π –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ
-   **–ü–∞–≥–∏–Ω–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `offset` –∏ `limit` –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
-   **–ë–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `useInfiniteQuery` —Å –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ–π –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
-   **–ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø–æ–¥—Å—á–µ—Ç:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø–æ–¥—Å—á–µ—Ç (`getArtistPostsCount`) –≤–º–µ—Å—Ç–æ `array.length`

**IPC-–º–µ—Ç–æ–¥—ã —Å–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ Limits:**

-   `getArtistPosts()` - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞–∫—Å–∏–º—É–º 50 –ø–æ—Å—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
-   `getTrackedArtists()` - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω, –µ—Å–ª–∏ –≤—ã –æ–∂–∏–¥–∞–µ—Ç–µ –±–æ–ª–µ–µ 1000 Artist'–æ–≤ (–≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –±–µ–∑ Limit, –Ω–æ —Ç–∞–±–ª–∏—Ü–∞ Artist'–æ–≤ –æ–±—ã—á–Ω–æ –Ω–µ–≤–µ–ª–∏–∫–∞)

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**

-   –î–æ—Å—Ç—É–ø –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö **–Ω–∏–∫–æ–≥–¥–∞** –Ω–µ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –∏–∑ Renderer Process (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
-   –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã **—Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã** —á–µ—Ä–µ–∑ Drizzle ORM
-   –û–ø–µ—Ä–∞—Ü–∏–∏ **—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã** –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
-   –†–µ–∂–∏–º WAL –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç **–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —á—Ç–µ–Ω–∏—è** –≤–æ –≤—Ä–µ–º—è –∑–∞–ø–∏—Å–∏
-   **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `limit`** –¥–ª—è SELECT-–∑–∞–ø—Ä–æ—Å–æ–≤, —á—Ç–æ–±—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –ø–µ—Ä–µ–≥—Ä—É–∑–∫—É Renderer Process

## –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

### Main Process (–ú–æ–∑–≥)

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `src/main/`

**–û–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏:**

-   –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö (SQLite —á–µ—Ä–µ–∑ Drizzle ORM)
-   –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –≤–Ω–µ—à–Ω–∏–º–∏ API
-   –û–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π
-   –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞–Ω–∏—è –ø–æ –æ–ø—Ä–æ—Å—É
-   –û–ø–µ—Ä–∞—Ü–∏–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é

**–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

1.  **–ö–ª–∏–µ–Ω—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** (`src/main/db/client.ts`)
    -   –ü—Ä—è–º–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ SQLite —á–µ—Ä–µ–∑ `better-sqlite3`
    -   –†–µ–∂–∏–º WAL (Write-Ahead Logging) –≤–∫–ª—é—á–µ–Ω –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö —á—Ç–µ–Ω–∏–π
    -   –£–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π –∏ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    -   –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ `getDb()` –∏ `getSqliteInstance()`
    -   –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

2.  **–°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** (`src/main/db/schema.ts`)
    -   –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ö–µ–º—ã Drizzle ORM –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
    -   –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ Indexes
    -   –¢–∞–±–ª–∏—Ü—ã: `artists`, `posts`, `settings`
    -   –í—ã–≤–æ–¥ —Ç–∏–ø–æ–≤: `Artist`, `Post`, `Settings`, `NewArtist`, `NewPost`

3.  **–°–µ—Ä–≤–∏—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (Sync Service)** (`src/main/services/sync-service.ts`)
    -   –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é API Rule34.xxx
    -   –†–µ–∞–ª–∏–∑—É–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—é
    -   –°–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç—ã API —Å–æ —Å—Ö–µ–º–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    -   –û–±–Ω–æ–≤–ª—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤ Artist
    -   –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è/–ø–æ–≤—Ç–æ—Ä–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–ª—è Artist'–æ–≤
    -   –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç IPC-—Å–æ–±—ã—Ç–∏—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

4.  **IPC-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã** (`src/main/ipc/controllers/`)
    -   –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ —Å –±–∞–∑–æ–≤—ã–º –∫–ª–∞—Å—Å–æ–º `BaseController`
    -   –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é Zod-—Å—Ö–µ–º
    -   –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º DI Container
    -   –ö–∞–∂–¥—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –æ–±–ª–∞—Å—Ç—å IPC-–æ–ø–µ—Ä–∞—Ü–∏–π

    **–ú–æ–¥—É–ª–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤:**
    -   `ArtistsController.ts` - –û–ø–µ—Ä–∞—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Artist'–∞–º–∏
    -   `PostsController.ts` - –û–ø–µ—Ä–∞—Ü–∏–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å Post'–∞–º–∏
    -   `SettingsController.ts` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Settings
    -   `AuthController.ts` - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    -   `MaintenanceController.ts` - –û–ø–µ—Ä–∞—Ü–∏–∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è/–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    -   `ViewerController.ts` - –û–ø–µ—Ä–∞—Ü–∏–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å Viewer
    -   `FileController.ts` - –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞–º–∏
    -   `SystemController.ts` - –°–∏—Å—Ç–µ–º–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–≤–µ—Ä—Å–∏—è, –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ –∏ —Ç.–¥.)

    **BaseController** (`src/main/core/ipc/BaseController.ts`):
    -   –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
    -   –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é Zod-—Å—Ö–µ–º
    -   –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
    -   –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏ –¥—É–±–ª–∏—Ä—É—é—â–µ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

    **‚ö†Ô∏è –í–ê–ñ–ù–û: –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Limits –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö**

    –ü—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ IPC-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, **–≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `limit`** –≤ –≤–∞—à–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö Drizzle. –ë–µ–∑ Limits, SQLite –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –¥–µ—Å—è—Ç–∫–∏ –∏–ª–∏ —Å–æ—Ç–Ω–∏ —Ç—ã—Å—è—á –∑–∞–ø–∏—Å–µ–π, —á—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫:

    -   **–ü–µ—Ä–µ–≥—Ä—É–∑–∫–µ Renderer Process** - –ë–æ–ª—å—à–∏–µ –º–∞—Å—Å–∏–≤—ã –±–ª–æ–∫–∏—Ä—É—é—Ç IPC –∏ –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞—é—Ç UI
    -   **–ò—Å—á–µ—Ä–ø–∞–Ω–∏—é –ø–∞–º—è—Ç–∏** - –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ–ª–µ–µ 100 —Ç—ã—Å—è—á –∑–∞–ø–∏—Å–µ–π –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –æ–±—ä–µ–º –ø–∞–º—è—Ç–∏
    -   **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–µ IPC Channel** - –ë–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—Ç –¥—Ä—É–≥–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

    **–ü—Ä–∏–º–µ—Ä –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ:**

    ```typescript
    // ‚úÖ CORRECT: Always use limit
    export class PostsController extends BaseController {
      setup() {
        this.handle(
          IPC_CHANNELS.DB.GET_POSTS,
          GetPostsSchema,
          this.getPosts.bind(this)
        );
      }
    
      private async getPosts(
        _event: IpcMainInvokeEvent,
        data: GetPostsRequest
      ) {
        const db = container.resolve(DI_TOKENS.DB);
        const { artistId, page = 1 } = data;
        const limit = 50; // ‚Üê CRITICAL: Always limit results
        const offset = (page - 1) * limit;
    
        return await db.query.posts.findMany({
          where: eq(posts.artistId, artistId),
          orderBy: [desc(posts.postId)],
          limit, // ‚Üê Required
          offset,
        });
      }
    }
    ```

    **Limits –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
    -   Post'—ã: 50 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É (–º–∞–∫—Å. 1000 –Ω–∞ –∑–∞–ø—Ä–æ—Å)
    -   Artist'—ã: –ë–µ–∑ Limit (–æ–±—ã—á–Ω–æ –º–∞–ª–æ, –Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–∂–∏–¥–∞–µ—Ç—Å—è > 1000)
    -   Settings: –û–¥–Ω–∞ –∑–∞–ø–∏—Å—å (Limit –Ω–µ –Ω—É–∂–µ–Ω)

    **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
    -   **–¢—è–∂–µ–ª—ã–µ –∑–∞–ø—Ä–æ—Å—ã** (–ø–æ–ª–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã, —Å–ª–æ–∂–Ω—ã–µ WHERE-—É—Å–ª–æ–≤–∏—è) ‚Üí –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞–≥–∏–Ω–∞—Ü–∏—é
    -   **–ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã** (WHERE –ø–æ –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Å—Ç–æ–ª–±—Ü–∞–º) ‚Üí –ú–æ–≥—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –±–æ–ª—å—à–∏–µ Limits (–¥–æ 1000)
    -   **–ù–µ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã** ‚Üí –î–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–≥–∏–µ Limits (50-100) –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
    -   **WAL mode** ‚Üí –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö —á—Ç–µ–Ω–∏–π (–≤–∫–ª—é—á–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

5.  **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (Dependency Injection Container)** (`src/main/core/di/Container.ts`)
    -   –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ Token
    -   –ü–∞—Ç—Ç–µ—Ä–Ω Singleton –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞–º–∏
    -   –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
    -   –°–µ—Ä–≤–∏—Å—ã: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, SyncService

6.  **–ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã Booru** (`src/main/providers/`)
    -   –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ Provider –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö Booru
    -   –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å `IBooruProvider` –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö Booru-–æ–ø–µ—Ä–∞—Ü–∏–π
    -   –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏: `Rule34Provider`, `GelbooruProvider`
    -   –ú–µ—Ç–æ–¥—ã: `checkAuth`, `fetchPosts`, `searchTags`, `formatTag`

7.  **–°–µ—Ä–≤–∏—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (Updater Service)** (`src/main/services/updater-service.ts`)
    -   –£–ø—Ä–∞–≤–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ `electron-updater`
    -   –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É –∏ —É—Å—Ç–∞–Ω–æ–≤–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
    -   –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç IPC-—Å–æ–±—ã—Ç–∏—è –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    -   –ó–∞–≥—Ä—É–∑–∫–∞, –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–∞—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º (—Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –∑–∞–≥—Ä—É–∑–∫–∏)

8.  **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (Secure Storage)** (`src/main/services/secure-storage.ts`)
    -   –®–∏—Ñ—Ä—É–µ—Ç –∏ –¥–µ—à–∏—Ñ—Ä—É–µ—Ç –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Electron `safeStorage` API
    -   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö API –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø–æ–∫–æ—è
    -   –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –≤ Main Process –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
    -   –ú–µ—Ç–æ–¥—ã: encrypt, decrypt

9.  **Bridge** (`src/main/bridge.ts`)
    -   –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç IPC-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    -   –î–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç Preload
    -   –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç —Å–≤—è–∑–∏
    -   –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Event listener'–∞–º–∏ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

10. **–û—Å–Ω–æ–≤–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (Main Entry)** (`src/main/main.ts`)
    -   –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    -   –°–æ–∑–¥–∞–Ω–∏–µ –æ–∫–Ω–∞
    -   –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
    -   –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –º–∏–≥—Ä–∞—Ü–∏–∏ worker thread –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### Renderer Process (–õ–∏—Ü–æ)

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `src/renderer/`

**–û–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏:**

-   –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
-   –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
-   –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ State
-   –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

1.  **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ React** (`src/renderer/App.tsx`)
    -   –û—Å–Ω–æ–≤–Ω–æ–π UI Component —Å –ª–æ–≥–∏–∫–æ–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏
    -   –≠–∫—Ä–∞–Ω Onboarding –¥–ª—è —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö API
    -   –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏
    -   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç TanStack Query –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
    -   –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ State —á–µ—Ä–µ–∑ React hooks –∏ Zustand

2.  **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** (`src/renderer/components/`)
    -   **–°—Ç—Ä–∞–Ω–∏—Ü—ã (Pages):**
        -   **Updates.tsx** - –õ–µ–Ω—Ç–∞ –ø–æ–¥–ø–∏—Å–æ–∫ (–∑–∞–≥–ª—É—à–∫–∞ - placeholder Component)
        -   **Browse.tsx** - –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –ø–æ—Å—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π (–∑–∞–≥–ª—É—à–∫–∞ - placeholder Component)
        -   **Favorites.tsx** - –ö–æ–ª–ª–µ–∫—Ü–∏—è –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ (–∑–∞–≥–ª—É—à–∫–∞ - placeholder Component)
        -   **Tracked.tsx** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Artist'–∞–º–∏ –∏ Tag'–∞–º–∏ (–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
        -   **Settings.tsx** - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
        -   **ArtistDetails.tsx** - –ü—Ä–æ—Å–º–æ—Ç—Ä –≥–∞–ª–µ—Ä–µ–∏ Artist'–∞ (–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
        -   **Onboarding.tsx** - –§–æ—Ä–º–∞ –≤–≤–æ–¥–∞ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö API (–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
    -   **–ú–∞–∫–µ—Ç (Layout):**
        -   **AppLayout.tsx** - –û—Å–Ω–æ–≤–Ω–æ–π –º–∞–∫–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª—å—é –∏ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –≤–µ—Ä—Ö–Ω–µ–π –ø–∞–Ω–µ–ª—å—é
        -   **Sidebar.tsx** - –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –±–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ —Å –∫–Ω–æ–ø–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏ –≤—ã—Ö–æ–¥–æ–º –∏–∑ —Å–∏—Å—Ç–µ–º—ã
        -   **GlobalTopBar.tsx** - –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å –ø–æ–ª–µ–º –ø–æ–∏—Å–∫–∞, –≤—ã–ø–∞–¥–∞—é—â–∏–º —Å–ø–∏—Å–∫–æ–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏, –∫–Ω–æ–ø–∫–æ–π —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º –≤–∏–¥–∞ (UI —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –±—ç–∫–µ–Ω–¥-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ –æ–∂–∏–¥–∞–Ω–∏–∏)
    -   **–ì–∞–ª–µ—Ä–µ—è (Gallery):**
        -   **ArtistCard.tsx** - Component –∫–∞—Ä—Ç–æ—á–∫–∏ Artist'–∞
        -   **ArtistGallery.tsx** - –°–µ—Ç–∫–∞ –ø–æ—Å—Ç–æ–≤ –¥–ª—è Artist'–∞
        -   **PostCard.tsx** - Component –æ—Ç–¥–µ–ª—å–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ Post'–∞
    -   **–ü—Ä–æ—Å–º–æ—Ç—Ä—â–∏–∫ (Viewer):**
        -   **ViewerDialog.tsx** - –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π Viewer —Å –∑–∞–≥—Ä—É–∑–∫–æ–π, –∏–∑–±—Ä–∞–Ω–Ω—ã–º, –≥–æ—Ä—è—á–∏–º–∏ –∫–ª–∞–≤–∏—à–∞–º–∏
    -   **–î–∏–∞–ª–æ–≥–∏ (Dialogs):**
        -   **AddArtistModal.tsx** - –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö Artist'–æ–≤
        -   **DeleteArtistDialog.tsx** - –î–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è Artist'–∞
        -   **UpdateNotification.tsx** - Component —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
    -   **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ (Settings):**
        -   **BackupControls.tsx** - –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∑–µ—Ä–≤–Ω—ã–º –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    -   **–≠–ª–µ–º–µ–Ω—Ç—ã –≤–≤–æ–¥–∞ (Inputs):**
        -   **AsyncAutocomplete.tsx** - Component –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Å –ª–æ–∫–∞–ª—å–Ω—ã–º –∏ —É–¥–∞–ª–µ–Ω–Ω—ã–º –ø–æ–∏—Å–∫–æ–º
    -   **ui/** - shadcn/ui Components (Button, Dialog, Select, Input –∏ —Ç.–¥.)

3.  **IPC Client** (`window.api`)
    -   –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫ Main Process
    -   –í—Å—è —Å–≤—è–∑—å –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —ç—Ç–æ—Ç Bridge
    -   –ú–µ—Ç–æ–¥—ã: getSettings, saveSettings, getTrackedArtists, addArtist, deleteArtist, getArtistPosts, getArtistPostsCount, syncAll, openExternal, searchArtists, searchRemoteTags, markPostAsViewed, togglePostViewed, togglePostFavorite, downloadFile, openFileInFolder, createBackup, restoreBackup, writeToClipboard, verifyCredentials, logout, resetPostCache, repairArtist, checkForUpdates, quitAndInstall, startDownload

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –°–ª–æ–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```mermaid
graph TB
    subgraph "Renderer Process (Sandboxed)"
        ReactUI[React UI]
        BridgeAPI[window.api]
    end

    subgraph "IPC Bridge (Secure)"
        Preload[preload.ts]
        ContextIsolation[Context Isolation]
    end

    subgraph "Main Process (Secure)"
        IPCHandlers[IPC Handlers]
        ZodValidation[Zod Validation]
        Services[Services]
    end

    subgraph "Secure Storage"
        SafeStorage[Electron safeStorage]
        Keychain[Platform Keychain]
    end

    subgraph "Main Process Database"
        DrizzleORM[Drizzle ORM]
        SQLite[(SQLite<br/>WAL Mode)]
    end

    ReactUI -->|Only via| BridgeAPI
    BridgeAPI -->|contextBridge| Preload
    Preload -->|contextIsolation: true| ContextIsolation
    ContextIsolation -->|Validated| IPCHandlers
    IPCHandlers -->|Zod Schema| ZodValidation
    ZodValidation -->|Validated Input| Services
    Services -->|Encrypted| SafeStorage
    SafeStorage -->|Platform API| Keychain
    Services -->|Direct Query| DrizzleORM
    DrizzleORM -->|SQL| SQLite

    style ReactUI fill:#e1f5ff
    style ContextIsolation fill:#fff4e1
    style ZodValidation fill:#ffe1e1
    style SafeStorage fill:#e1ffe1
    style DrizzleORM fill:#f0e1ff
```

### –ò–∑–æ–ª—è—Ü–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–∫–ª—é—á–µ–Ω–æ

Renderer Process —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ –±–µ–∑ –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ Node.js. –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∞—Ç–∞–∫–∏ Remote Code Execution (RCE).

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**

```typescript
webPreferences: {
  contextIsolation: true,  // Required
  nodeIntegration: false,  // Never true
  sandbox: true,           // Additional security
  preload: path.join(__dirname, "../preload/bridge.cjs"),
}
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å IPC

**‚ö†Ô∏è –í–ê–ñ–ù–û: –ö–æ–Ω—Ç—Ä–∞–∫—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ API Key**

–°–ª–æ–π IPC –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å—Ç—Ä–æ–≥–∏–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö API:

-   **`saveSettings(creds: { userId: string; apiKey: string })`** - –ü—Ä–∏–Ω–∏–º–∞–µ—Ç API key –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ (–Ω–µ–∏–∑–±–µ–∂–Ω–æ –ø—Ä–∏ Onboarding)
-   **`getSettings()`** - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `IpcSettings` —Å `hasApiKey: boolean`, **–ù–ò–ö–û–ì–î–ê —Å–∞–º API key**
-   **–ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª API Key:**
    -   –í–≤–µ–¥–µ–Ω –≤ Renderer ‚Üí –û—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ Main —á–µ—Ä–µ–∑ IPC ‚Üí –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω –≤ Main ‚Üí –•—Ä–∞–Ω–∏—Ç—Å—è –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ
    -   **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç—Å—è –¥–ª—è Renderer** - –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ Main Process, –∫–æ–≥–¥–∞ —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –≤—ã–∑–æ–≤–æ–≤ API (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ `SyncService`)

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:** –ï—Å–ª–∏ `getSettings()` –≤–æ–∑–≤—Ä–∞—â–∞–ª –±—ã API key, –ª—é–±–æ–π —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Renderer Process (XSS, –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏ —Ç.–¥.) –º–æ–≥ –±—ã —É–∫—Ä–∞—Å—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –ë—É–ª–µ–≤ —Ñ–ª–∞–≥ `hasApiKey` –ø–æ–∑–≤–æ–ª—è–µ—Ç UI –ø—Ä–æ–≤–µ—Ä—è—Ç—å, –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ª–∏ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—è —Å–∞–º –∫–ª—é—á.

1.  **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –í—Å—è IPC-—Å–≤—è–∑—å —Å—Ç—Ä–æ–≥–æ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
2.  **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:** –í—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –≤ Main Process —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Zod-—Å—Ö–µ–º
3.  **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** –û—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –±–µ–∑ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4.  **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ Node:** Renderer –Ω–µ –º–æ–∂–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ Node.js API
5.  **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:** API keys —à–∏—Ñ—Ä—É—é—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø–æ–∫–æ—è, **–ù–ò–ö–û–ì–î–ê –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ Renderer** (—Ç–æ–ª—å–∫–æ –±—É–ª–µ–≤ —Ñ–ª–∞–≥ `hasApiKey`)
6.  **–ò–∑–æ–ª—è—Ü–∏—è Worker Thread:** –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –≤ worker thread

### –ü–æ—Ç–æ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```mermaid
sequenceDiagram
    participant User
    participant ReactUI as React UI
    participant Bridge as IPC Bridge
    participant IPC as IPC Handler
    participant SecureStorage as Secure Storage
    participant Keychain as Platform Keychain
    participant DB as Database

    User->>ReactUI: Enter API Credentials
    ReactUI->>Bridge: window.api.saveSettings({userId, apiKey})
    Bridge->>IPC: ipcRenderer.invoke('app:save-settings')
    IPC->>SecureStorage: encrypt(apiKey)
    SecureStorage->>Keychain: safeStorage.encryptString()
    Keychain-->>SecureStorage: Encrypted Buffer
    SecureStorage-->>IPC: Encrypted String
    IPC->>DB: Save (encrypted)
    DB-->>IPC: Success
    IPC-->>Bridge: Promise Resolve
    Bridge-->>ReactUI: Success

    Note over DB,Keychain: API Key never stored in plaintext

    ReactUI->>Bridge: window.api.getSettings()
    Bridge->>IPC: ipcRenderer.invoke('app:get-settings')
    IPC->>DB: Get Settings
    DB-->>IPC: {userId, encryptedKey, ...}
    Note over IPC: mapSettingsToIpc() converts to safe format
    Note over IPC: apiKey is NEVER decrypted for Renderer
    IPC-->>Bridge: {userId, hasApiKey: boolean, ...}
    Bridge-->>ReactUI: IpcSettings (NO apiKey field)

    Note over ReactUI,Keychain: ‚ö†Ô∏è SECURITY: API Key NEVER returned to Renderer
```

**–ü–æ–Ω—è—Ç–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

1.  **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (Onboarding):**
    -   –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç API key –≤ Renderer (–æ—Ç–∫—Ä—ã—Ç—ã–º —Ç–µ–∫—Å—Ç–æ–º, —á—Ç–æ –Ω–µ–∏–∑–±–µ–∂–Ω–æ –≤–æ –≤—Ä–µ–º—è –≤–≤–æ–¥–∞)
    -   `saveSettings()` –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ IPC –≤ Main Process
    -   Main Process —à–∏—Ñ—Ä—É–µ—Ç API key —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Electron `safeStorage` API (—Å–≤—è–∑–∫–∞ –∫–ª—é—á–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã)
    -   –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    -   Renderer –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É—Å–ø–µ—Ö–∞ (—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è)

2.  **–ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ (–ö–æ–Ω—Ç—Ä–∞–∫—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏):**
    -   `getSettings()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ Renderer
    -   Main Process –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    -   **‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ü–†–ê–í–ò–õ–û –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò: API Key –ù–ò–ö–û–ì–î–ê –Ω–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç—Å—è –¥–ª—è Renderer**
    -   –§—É–Ω–∫—Ü–∏—è `mapSettingsToIpc()` –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∑–∞–ø–∏—Å—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç IPC:
        -   ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `userId` (–±–µ–∑–æ–ø–∞—Å–Ω–æ, –Ω–µ—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ)
        -   ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `hasApiKey: boolean` (—Ñ–ª–∞–≥, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –∫–ª—é—á, –±–µ–∑–æ–ø–∞—Å–Ω–æ)
        -   ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: –î—Ä—É–≥–∏–µ —Ñ–ª–∞–≥–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ (safe mode, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤–æ–∑—Ä–∞—Å—Ç–∞ –∏ —Ç.–¥.)
        -   ‚ùå **–ù–ò–ö–û–ì–î–ê –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `apiKey` (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–ª–∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π)
    -   Renderer –ø–æ–ª—É—á–∞–µ—Ç —Ç–∏–ø `IpcSettings`, –∫–æ—Ç–æ—Ä—ã–π **–Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª—è `apiKey`**
    -   API key —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ Main Process, –∫–æ–≥–¥–∞ —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –≤—ã–∑–æ–≤–æ–≤ API (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ `SyncService`)

**–ö–æ–Ω—Ç—Ä–∞–∫—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**

-   **–í–≤–æ–¥ (saveSettings):** API key –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∏–∑ Renderer –æ—Ç–∫—Ä—ã—Ç—ã–º —Ç–µ–∫—Å—Ç–æ–º (–Ω–µ–∏–∑–±–µ–∂–Ω–æ –ø—Ä–∏ Onboarding)
-   **–•—Ä–∞–Ω–µ–Ω–∏–µ:** API key —à–∏—Ñ—Ä—É–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–≤—è–∑–∫–∏ –∫–ª—é—á–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã, —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
-   **–í—ã–≤–æ–¥ (getSettings):** Renderer –ø–æ–ª—É—á–∞–µ—Ç `IpcSettings` —Å `hasApiKey: boolean`, **–ù–ò–ö–û–ì–î–ê —Å–∞–º –∫–ª—é—á**
-   **–í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** API key —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ Main Process –¥–ª—è –≤—ã–∑–æ–≤–æ–≤ API, –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥–ª—è Renderer

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:**

–ï—Å–ª–∏ `getSettings()` –≤–æ–∑–≤—Ä–∞—â–∞–ª –±—ã API key (–¥–∞–∂–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π), –ª—é–±–æ–π —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Renderer Process (XSS, –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏ —Ç.–¥.) –º–æ–≥ –±—ã —É–∫—Ä–∞—Å—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –í–æ–∑–≤—Ä–∞—â–∞—è —Ç–æ–ª—å–∫–æ –±—É–ª–µ–≤ —Ñ–ª–∞–≥, Renderer –º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ª–∏ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤–∏–¥—è —Å–∞–º –∫–ª—é—á.

## –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

### –ü–æ—Ç–æ–∫ —á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

–°—Ö–µ–º–∞ –Ω–∏–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ —Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ UI. **–ü—Ä–æ—á—Ç–∏—Ç–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ**, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å –ø–æ–ª–Ω—ã–π –ø–æ—Ç–æ–∫.

```mermaid
sequenceDiagram
    participant User
    participant ReactUI as React UI
    participant ReactQuery as TanStack Query
    participant Bridge as IPC Bridge
    participant IPC as IPC Handler
    participant DB as SQLite (Drizzle)

    User->>ReactUI: Click "View Artists"
    ReactUI->>ReactQuery: useQuery(['artists'])
    ReactQuery->>Bridge: window.api.getTrackedArtists()
    Bridge->>IPC: ipcRenderer.invoke('db:get-artists')
    IPC->>IPC: Validate (Zod)
    IPC->>DB: Drizzle Query
    DB-->>IPC: Artist[]
    IPC-->>Bridge: IPC Response
    Bridge-->>ReactQuery: Promise Resolve
    ReactQuery->>ReactQuery: Cache Data
    ReactQuery-->>ReactUI: Update UI
    ReactUI-->>User: Display Artists
```

**–†–µ–∞–ª—å–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É "Tracked"**

1.  **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "Tracked"** –≤ –±–æ–∫–æ–≤–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

2.  **React Component —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è** - Component `Tracked.tsx` –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –∏ –≤—ã–∑—ã–≤–∞–µ—Ç:
    ```typescript
    const { data: artists } = useQuery({
      queryKey: ["artists"],
      queryFn: () => window.api.getTrackedArtists(),
    });
    ```

3.  **React Query –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫—ç—à** - React Query —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ —É –Ω–µ–≥–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è `["artists"]`. –ï—Å–ª–∏ –¥–∞, –æ–Ω –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–±–µ–∑ —Å–µ—Ç–µ–≤–æ–≥–æ –≤—ã–∑–æ–≤–∞).

4.  **–í—ã–∑–æ–≤ IPC** - –ï—Å–ª–∏ –∫—ç—à –ø—É—Å—Ç –∏–ª–∏ —É—Å—Ç–∞—Ä–µ–ª, React Query –≤—ã–∑—ã–≤–∞–µ—Ç `window.api.getTrackedArtists()`, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ IPC bridge –≤ Main Process.

5.  **–í–∞–ª–∏–¥–∞—Ü–∏—è** - IPC-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–∞–ø—Ä–æ—Å (—Ö–æ—Ç—è `getTrackedArtists` –Ω–µ –∏–º–µ–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ —Ä–∞–≤–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏).

6.  **–ó–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö** - –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å Drizzle:
    ```typescript
    const artists = await db.query.artists.findMany({
      orderBy: [asc(artists.name)],
    });
    ```

7.  **–û—Ç–≤–µ—Ç** - –ú–∞—Å—Å–∏–≤ Artist'–æ–≤ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è:
    -   –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ‚Üí IPC Handler ‚Üí IPC Bridge ‚Üí React Query ‚Üí Component

8.  **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - React Query –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Ö–æ–¥–∏—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è, –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–∞—é—Ç—Å—è –∏–∑ –∫—ç—à–∞ (–º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞).

9.  **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI** - React –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è —Å –¥–∞–Ω–Ω—ã–º–∏ Artist'–æ–≤, –æ—Ç–æ–±—Ä–∞–∂–∞—è –∏—Ö –≤ –≤–∏–¥–µ —Å–µ—Ç–∫–∏.

**–ü–æ—á–µ–º—É React Query?**

-   **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –î–∞–Ω–Ω—ã–µ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
-   **–°–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏** - –°–æ—Å—Ç–æ—è–Ω–∏—è `isLoading` –∏ `error` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
-   **–§–æ–Ω–æ–≤–∞—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞** - –ú–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—É—é –≤—ã–±–æ—Ä–∫—É –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ, –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏
-   **–û–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** - –ú–æ–∂–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å UI –¥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–æ–º (–¥–ª—è –º—É—Ç–∞—Ü–∏–π)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**

-   –ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞: ~50-100 –º—Å (–∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö + –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã IPC)
-   –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏: ~0 –º—Å (–æ–±—Å–ª—É–∂–∏–≤–∞—é—Ç—Å—è –∏–∑ –∫—ç—à–∞ React Query)
-   –§–æ–Ω–æ–≤–∞—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞: –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –Ω–µ –±–ª–æ–∫–∏—Ä—É—è UI

### –ü–æ—Ç–æ–∫ –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö

–°—Ö–µ–º–∞ –Ω–∏–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. **–ü—Ä–æ—á—Ç–∏—Ç–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ** –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø–æ—Ç–æ–∫–∞, –≤–∫–ª—é—á–∞—è –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫.

```mermaid
sequenceDiagram
    participant User
    participant ReactUI as React UI
    participant Bridge as IPC Bridge
    participant IPC as IPC Handler
    participant DB as SQLite (Drizzle)
    participant ReactQuery as TanStack Query

    User->>ReactUI: Submit "Add Artist" Form
    ReactUI->>Bridge: window.api.addArtist(data)
    Bridge->>IPC: ipcRenderer.invoke('db:add-artist', data)
    IPC->>IPC: Zod Validation
    alt Validation Failed
        IPC-->>Bridge: Error
        Bridge-->>ReactUI: Reject Promise
    else Validation Success
        IPC->>DB: Drizzle Insert
        DB-->>IPC: New Artist
        IPC-->>Bridge: IPC Response
        Bridge-->>ReactUI: Promise Resolve
        ReactUI->>ReactQuery: Invalidate Query
        ReactQuery->>ReactQuery: Refetch Data
        ReactQuery-->>ReactUI: Update UI
        ReactUI-->>User: Show Success
    end
```

**–†–µ–∞–ª—å–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤–æ–≥–æ Artist'–∞**

1.  **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –∏–º—è Artist'–∞ "example_artist", Tag "tag_name", –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–∏–ø "tag" –∏ –Ω–∞–∂–∏–º–∞–µ—Ç "Add".

2.  **–û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã** - React Component –≤—ã–∑—ã–≤–∞–µ—Ç:
    ```typescript
    const handleAddArtist = async (name, tag, type) => {
      await window.api.addArtist({ name, tag, type, provider: "rule34" });
    };
    ```

3.  **–í—ã–∑–æ–≤ IPC** - –ó–∞–ø—Ä–æ—Å –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ IPC bridge –≤ Main Process.

4.  **–í–∞–ª–∏–¥–∞—Ü–∏—è** - `ArtistsController` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é Zod-—Å—Ö–µ–º—ã:
    ```typescript
    // Zod schema checks:
    // - name is non-empty string
    // - tag is non-empty string
    // - apiEndpoint is valid URL
    ```

5.  **–î–≤–∞ –ø—É—Ç–∏:**

    **–ü—É—Ç—å –ê: –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å**
    -   Zod –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    -   `BaseController` –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –µ–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–¥–æ–±–Ω—É—é –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—à–∏–±–∫—É
    -   Promise –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è –≤ Renderer
    -   Component –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    -   **–ó–∞–ø–∏—Å—å –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**

    **–ü—É—Ç—å B: –í–∞–ª–∏–¥–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞**
    -   –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –≤—ã–∑—ã–≤–∞–µ—Ç —Å–µ—Ä–≤–∏—Å: `dbService.addArtist(validatedData)`
    -   –°–µ—Ä–≤–∏—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å—Ç–∞–≤–∫—É Drizzle:
        ```typescript
        await db.insert(artists).values({
          name: "example_artist",
          tag: "tag_name",
          // ... other fields
        }).returning();
        ```
    -   –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤–æ–≥–æ Artist'–∞ —Å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º ID
    -   –û—Ç–≤–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ Renderer

6.  **–ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞** - –í —Å–ª—É—á–∞–µ —É—Å–ø–µ—Ö–∞ Component –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∫—ç—à React Query:
    ```typescript
    queryClient.invalidateQueries({ queryKey: ["artists"] });
    ```

7.  **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞** - React Query –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏–∑–≤–ª–µ–∫–∞–µ—Ç `["artists"]`, –ø–æ—Å–∫–æ–ª—å–∫—É –∫—ç—à –±—ã–ª –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω.

8.  **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è UI** - –ù–æ–≤—ã–π Artist –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ (—Ä—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ State –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è).

**–ü–æ—á–µ–º—É —ç—Ç–æ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω?**

-   **–°–Ω–∞—á–∞–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è** - –ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
-   **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - TypeScript + Zod –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
-   **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è UI** - –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ UI –≤—Å–µ–≥–¥–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–∞–º—ã–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
-   **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –£–¥–æ–±–Ω—ã–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—à–∏–±–∫–∏, –∞ –Ω–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏ —Å—Ç–µ–∫–∞

**–ü—Ä–∏–º–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫:**

```typescript
try {
  await window.api.addArtist(data);
  // Success - cache invalidation happens automatically
} catch (error) {
  // Error could be:
  // - Validation error: "Username is required"
  // - Database error: "Tag already exists"
  // - Network error: "Failed to connect"
  
  log.error("Failed to add artist:", error);
  // Show error toast to user
}
```

### –ü–æ—Ç–æ–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

–°—Ö–µ–º–∞ –Ω–∏–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ–æ–Ω–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è. **–ü—Ä–æ—á—Ç–∏—Ç–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ**, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å –ø–æ–ª–Ω—ã–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø–æ—Ç–æ–∫ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.

```mermaid
sequenceDiagram
    participant User
    participant ReactUI as React UI
    participant Bridge as IPC Bridge
    participant IPC as IPC Handler
    participant SyncService as Sync Service
    participant SecureStorage as Secure Storage
    participant Rule34API as Rule34.xxx API
    participant DB as SQLite (Drizzle)

    User->>ReactUI: Click "Sync All"
    ReactUI->>Bridge: window.api.syncAll()
    Bridge->>IPC: ipcRenderer.invoke('db:sync-all')
    IPC->>SyncService: syncService.syncAllArtists()
    IPC-->>Bridge: Return (async)
    Bridge-->>ReactUI: Promise Resolve

    par For Each Artist
        SyncService->>DB: Get Artist List
        DB-->>SyncService: Artist[]

        SyncService->>SecureStorage: Decrypt API Key
        SecureStorage-->>SyncService: Decrypted Key

        SyncService->>Rule34API: GET /index.php?page=dapi&s=post&q=index
        Rule34API-->>SyncService: JSON Posts

        SyncService->>SyncService: Map API Response
        SyncService->>SyncService: Rate Limit (1.5s delay)

        SyncService->>DB: INSERT/UPDATE Posts (Bulk Upsert)
        SyncService->>DB: UPDATE Artist (lastPostId)
        DB-->>SyncService: Success

        SyncService->>ReactUI: emit('sync:progress', message)
        ReactUI->>ReactUI: Update Progress UI
    end

    SyncService->>ReactUI: emit('sync:end')
    ReactUI->>ReactUI: Show Completion
    ReactUI->>User: Sync Complete
```

**–†–µ–∞–ª—å–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "Sync All"**

1.  **–î–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "Sync All" –≤ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏ –∏–ª–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ Tracked.

2.  **–í—ã–∑–æ–≤ IPC** - Component –≤—ã–∑—ã–≤–∞–µ—Ç `window.api.syncAll()`. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è **–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ** (–Ω–µ –∂–¥–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏), –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ.

3.  **–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏** - `SyncService` –Ω–∞—á–∏–Ω–∞–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É Artist'–æ–≤. UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "Syncing...".

4.  **–î–ª—è –∫–∞–∂–¥–æ–≥–æ Artist'–∞ —Å–µ—Ä–≤–∏—Å:**

    a.  **–ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ Artist'–∞** –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
        ```typescript
        const artists = await db.query.artists.findMany();
        ```

    b.  **–†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç API key** - –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π API key —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Electron `safeStorage` API. –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –≤ Main Process (–±–µ–∑–æ–ø–∞—Å–Ω–æ).

    c.  **–ò–∑–≤–ª–µ–∫–∞–µ—Ç –ø–æ—Å—Ç—ã –∏–∑ API** - –í—ã–ø–æ–ª–Ω—è–µ—Ç HTTP-–∑–∞–ø—Ä–æ—Å –∫ Rule34.xxx API:
        ```
        GET https://api.rule34.xxx/index.php?page=dapi&s=post&q=index&tags=tag_name&limit=1000
        ```

    d.  **–°–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç API** - –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç JSON API –≤ —Ñ–æ—Ä–º–∞—Ç —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

    e.  **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏** - –ñ–¥–µ—Ç 1.5 —Å–µ–∫—É–Ω–¥—ã –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Å–ª–µ–¥—É—é—â–µ–≥–æ Artist'–∞ (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ API).

    f.  **–ú–∞—Å—Å–æ–≤–æ–µ upsert** - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Å—Ç—ã –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ `ON CONFLICT` (–æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ, –≤—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–µ):
        ```typescript
        await db.insert(posts).values(newPosts)
          .onConflictDoUpdate({
            target: [posts.artistId, posts.postId],
            set: { /* update fields */ }
          });
        ```

    g.  **–û–±–Ω–æ–≤–ª—è–µ—Ç Artist** - –û–±–Ω–æ–≤–ª—è–µ—Ç `lastPostId` –∏ `newPostsCount` Artist'–∞.

    h.  **–°–æ–±—ã—Ç–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞** - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç IPC-—Å–æ–±—ã—Ç–∏–µ: `emit('sync:progress', 'Syncing artist_name...')`

5.  **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è UI –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** - React Component —Å–ª—É—à–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:
    ```typescript
    useEffect(() => {
      const unsubscribe = window.api.onSyncProgress((message) => {
        setSyncMessage(message); // Update progress text
      });
      return () => unsubscribe();
    }, []);
    ```

6.  **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ** - –ö–æ–≥–¥–∞ –≤—Å–µ Artist'—ã –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã, —Å–µ—Ä–≤–∏—Å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ `sync:end`. UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ "Sync complete".

**–ü–æ—á–µ–º—É –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å —Å —Å–æ–±—ã—Ç–∏—è–º–∏?**

-   **–ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–π** - UI –æ—Å—Ç–∞–µ—Ç—Å—è –æ—Ç–∑—ã–≤—á–∏–≤—ã–º –≤–æ –≤—Ä–µ–º—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
-   **–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
-   **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –û—Ç–¥–µ–ª—å–Ω—ã–µ —Å–±–æ–∏ Artist'–æ–≤ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç –≤—Å—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
-   **–í–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º—ã–π** - –ú–æ–∂–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –ø–æ–∑–∂–µ

**–ü—Ä–∏–º–µ—Ä: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏**

```typescript
// In component
const [syncMessage, setSyncMessage] = useState<string | null>(null);

useEffect(() => {
  const unsubscribeStart = window.api.onSyncStart(() => {
    setSyncMessage("Starting sync...");
  });

  const unsubscribeProgress = window.api.onSyncProgress((message) => {
    setSyncMessage(message); // "Syncing artist_name..."
  });

  const unsubscribeEnd = window.api.onSyncEnd(() => {
    setSyncMessage("Sync complete!");
    // Refresh artist list to show new posts count
    queryClient.invalidateQueries({ queryKey: ["artists"] });
  });

  const unsubscribeError = window.api.onSyncError((error) => {
    setSyncMessage(`Sync error: ${error}`);
  });

  return () => {
    unsubscribeStart();
    unsubscribeProgress();
    unsubscribeEnd();
    unsubscribeError();
  };
}, []);
```

**–°–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**

-   **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏** - –ó–∞–¥–µ—Ä–∂–∫–∞ –≤ 1.5 —Å –º–µ–∂–¥—É Artist'–∞–º–∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫—É API
-   **–ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** - –ü–æ—Å—Ç—ã –≤—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –ø–∞—Ä—Ç–∏—è–º–∏ (200 –∑–∞ –ø–∞—Ä—Ç–∏—é) –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
-   **–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** - –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å—Ç—ã –Ω–æ–≤–µ–µ `lastPostId` (–Ω–µ –≤—Å–µ –ø–æ—Å—Ç—ã)
-   **–§–æ–Ω–æ–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ** - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç UI –∏–ª–∏ –¥—Ä—É–≥–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –°—Ö–µ–º–∞

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SQLite —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏:

1.  **artists** - –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ Artist'—ã/–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–ø–æ Tag'—É –∏–ª–∏ –∑–∞–≥—Ä—É–∑—á–∏–∫—É)
2.  **posts** - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç–æ–≤ —Å Tag'–∞–º–∏, —Ä–µ–π—Ç–∏–Ω–≥–∞–º–∏ –∏ URL
3.  **settings** - –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ API (User ID –∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π API Key), safe mode, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤–æ–∑—Ä–∞—Å—Ç–∞

–°–º. [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö](./database.md) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ö–µ–º–µ.

### ORM-—Å–ª–æ–π

**Drizzle ORM** –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:

-   –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
-   –ú–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã
-   –í—ã–≤–æ–¥ —Ç–∏–ø–æ–≤
-   –ì–µ–Ω–µ—Ä–∞—Ü–∏—é SQL

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–ö–ª–∏–µ–Ω—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** (`src/main/db/client.ts`):

-   –ü—Ä—è–º–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ SQLite —á–µ—Ä–µ–∑ `better-sqlite3`
-   –†–µ–∂–∏–º WAL (Write-Ahead Logging) –≤–∫–ª—é—á–µ–Ω –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö —á—Ç–µ–Ω–∏–π
-   –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
-   –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ Drizzle ORM
-   –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –≤ Main Process

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### –ò–µ—Ä–∞—Ä—Ö–∏—è React –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```mermaid
graph TD
    App[App.tsx]
    AppLayout[AppLayout]
    Sidebar[Sidebar]
    GlobalTopBar[GlobalTopBar]

    App --> AppLayout
    AppLayout --> Sidebar
    AppLayout --> GlobalTopBar

    subgraph "Pages"
        Updates[Updates]
        Browse[Browse]
        Favorites[Favorites]
        Tracked[Tracked]
        Settings[Settings]
        ArtistDetails[ArtistDetails]
        Onboarding[Onboarding]
    end

    AppLayout --> Updates
    AppLayout --> Browse
    AppLayout --> Favorites
    AppLayout --> Tracked
    AppLayout --> Settings
    AppLayout --> ArtistDetails
    AppLayout --> Onboarding

    subgraph "Shared Components"
        ArtistGallery[ArtistGallery]
        PostCard[PostCard]
        ViewerDialog[ViewerDialog]
        AddArtistModal[AddArtistModal]
    end

    Tracked --> ArtistGallery
    ArtistDetails --> ArtistGallery
    ArtistGallery --> PostCard
    PostCard --> ViewerDialog
    Tracked --> AddArtistModal
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ API

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ Provider

–í—ã–∑–æ–≤—ã –≤–Ω–µ—à–Ω–∏—Ö API –∞–±—Å—Ç—Ä–∞–≥–∏—Ä–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ **–ü–∞—Ç—Ç–µ—Ä–Ω Provider** (`src/main/providers/`):

1.  **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å IBooruProvider:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ—Ö Booru-–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
    -   `checkAuth()` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    -   `fetchPosts()` - –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–≤ –ø–æ Tag'–∞–º
    -   `searchTags()` - –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ Tag'–æ–≤
    -   `formatTag()` - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Tag'–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∏–ø–∞ Artist'–∞
    -   `getDefaultApiEndpoint()` - –ü–æ–ª—É—á–µ–Ω–∏–µ URL API endpoint

2.  **–†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞:**
    -   `Rule34Provider` - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Rule34.xxx API
    -   `GelbooruProvider` - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Gelbooru API

3.  **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SyncService:**
    -   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω Provider –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å—Ç–æ–≤
    -   **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏:** –ó–∞–¥–µ—Ä–∂–∫–∞ 1.5 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É Artist'–∞–º–∏, 0.5 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏
    -   **–ü–∞–≥–∏–Ω–∞—Ü–∏—è:** –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏—é, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—É—é –¥–ª—è Booru (–¥–æ 1000 –ø–æ—Å—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É)
    -   **–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:** –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å—Ç—ã –Ω–æ–≤–µ–µ `lastPostId`
    -   **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API –∏ —Å–±–æ–µ–≤ —Å–µ—Ç–∏
    -   **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç User ID –∏ API Key –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Settings

### –ü–æ—Ç–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏

```mermaid
sequenceDiagram
    participant User
    participant Viewer as ViewerDialog
    participant Bridge as IPC Bridge
    participant IPC as IPC Handler
    participant FileHandler as File Handler
    participant FileSystem as File System

    User->>Viewer: Click "Download"
    Viewer->>Bridge: window.api.downloadFile(url, filename)
    Bridge->>IPC: ipcRenderer.invoke('files:download', url, filename)
    IPC->>FileHandler: downloadFile(url, filename)
    FileHandler->>FileSystem: Show Save Dialog
    FileSystem-->>FileHandler: User Selected Path

    par Download Process
        FileHandler->>FileHandler: Fetch File Stream
        FileHandler->>FileSystem: Write Chunks
        FileHandler->>Viewer: emit('files:download-progress', {id, percent})
        Viewer->>Viewer: Update Progress Bar
    end

    FileHandler->>FileSystem: Complete Write
    FileSystem-->>FileHandler: Success
    FileHandler-->>IPC: {success: true, path}
    IPC-->>Bridge: IPC Response
    Bridge-->>Viewer: Promise Resolve
    Viewer->>User: Show Success Notification
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–±–æ—Ä–∫–∏

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å–±–æ—Ä–∫–∏: Vite

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **electron-vite** –¥–ª—è —Å–±–æ—Ä–∫–∏ –∫–∞–∫ Main, —Ç–∞–∫ –∏ Renderer –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** `electron.vite.config.ts`

**–¶–µ–ª–∏ —Å–±–æ—Ä–∫–∏:**

1.  **Main:** Node.js bundle (`out/main/`)
2.  **Preload:** CommonJS bridge (`out/preload/`)
3.  **Renderer:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ React (`out/renderer/`)

### –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

-   Hot Module Replacement (HMR) –¥–ª—è Renderer ‚úÖ
-   –ë—ã—Å—Ç—Ä–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ —Å Vite
-   DevTools –≤–∫–ª—é—á–µ–Ω—ã –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
-   Main Process: –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–æ–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ (–±–µ–∑ –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞) ‚ö†Ô∏è

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ State

### State Renderer

**TanStack Query (React Query):**

-   Server State (–¥–∞–Ω–Ω—ã–µ –∏–∑ Main Process)
-   –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
-   –°–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ—à–∏–±–æ–∫

**Zustand:**

-   Client-side UI State
-   –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π boilerplate
-   –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—É KISS

**‚ö†Ô∏è –í–ê–ñ–ù–û: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –°–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –Ω–µ–Ω—É–∂–Ω—ã—Ö –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö —Ä–µ–Ω–¥–µ—Ä–æ–≤**

Zustand Stores –º–æ–≥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã**, —á—Ç–æ–±—ã –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π State, –∫–æ—Ç–æ—Ä—ã–π –≤–∞–º –Ω—É–∂–µ–Ω, –∞ –Ω–µ –Ω–∞ –≤–µ—Å—å Store.

**–ü–æ—á–µ–º—É —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –≤–∞–∂–Ω—ã:**

–ö–æ–≥–¥–∞ –≤—ã –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç–µ—Å—å –Ω–∞ –≤–µ—Å—å Store, Component –ø–æ–≤—Ç–æ—Ä–Ω–æ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è –ø—Ä–∏ **–ª—é–±–æ–º** –∏–∑–º–µ–Ω–µ–Ω–∏–∏ State, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç—É —á–∞—Å—Ç—å State. –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
-   –ù–µ–Ω—É–∂–Ω—ã–º –ø–æ–≤—Ç–æ—Ä–Ω—ã–º —Ä–µ–Ω–¥–µ—Ä–∞–º –±–æ–ª—å—à–∏—Ö –¥–µ—Ä–µ–≤—å–µ–≤ Component'–æ–≤
-   –°–Ω–∏–∂–µ–Ω–∏—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–æ —Å–ª–æ–∂–Ω—ã–º–∏ UI
-   –ó–∞–≤–∏—Å–∞–Ω–∏—é UI –ø—Ä–∏ —á–∞—Å—Ç—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö State

**‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –≤–µ—Å—å Store**

```typescript
// ‚ùå BAD: Component re-renders on ANY state change
const store = useViewerStore(); // Gets entire store
const isOpen = store.isOpen; // But only uses isOpen

// If controlsVisible changes, this component still re-renders!
```

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤**

```typescript
// ‚úÖ GOOD: Component only re-renders when isOpen changes
const isOpen = useViewerStore((state) => state.isOpen);

// Component ignores other state changes (controlsVisible, queue, etc.)
```

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ —Å useShallow**

–ö–æ–≥–¥–∞ –≤–∞–º –Ω—É–∂–Ω—ã –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏–π, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `useShallow`, —á—Ç–æ–±—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ —Ä–µ–Ω–¥–µ—Ä—ã –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –Ω–µ—Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ State:

```typescript
import { useShallow } from "zustand/react/shallow";

// ‚úÖ GOOD: Only re-renders when isOpen or close function changes
const { isOpen, close } = useViewerStore(
  useShallow((state) => ({
    isOpen: state.isOpen,
    close: state.close,
  }))
);

// ‚úÖ GOOD: Split into logical groups for better performance
const { currentPostId, queue } = useViewerStore(
  useShallow((state) => ({
    currentPostId: state.currentPostId,
    queue: state.queue,
  }))
);

const { currentIndex, next, prev } = useViewerStore(
  useShallow((state) => ({
    currentIndex: state.currentIndex,
    next: state.next,
    prev: state.prev,
  }))
);
```

**–ü—Ä–∏–º–µ—Ä –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–∏—Ä–∞ –∏–∑ ViewerDialog:**

```typescript
// In ViewerDialog.tsx - split selectors into logical groups
export const ViewerDialog = () => {
  // Group 1: Open/close state
  const { isOpen, close } = useViewerStore(
    useShallow((state) => ({
      isOpen: state.isOpen,
      close: state.close,
    }))
  );

  // Group 2: Current post data
  const { currentPostId, queue } = useViewerStore(
    useShallow((state) => ({
      currentPostId: state.currentPostId,
      queue: state.queue,
    }))
  );

  // Group 3: Navigation
  const { currentIndex, next, prev } = useViewerStore(
    useShallow((state) => ({
      currentIndex: state.currentIndex,
      next: state.next,
      prev: state.prev,
    }))
  );

  // Each group only re-renders when its specific values change
  // If controlsVisible changes, none of these groups re-render
};
```

**–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏:**

1.  **–ï–¥–∏–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ—Å—Ç–æ–π —Å–µ–ª–µ–∫—Ç–æ—Ä `useStore((s) => s.value)`
2.  **–ù–µ—Å–∫–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏–π:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `useShallow` —Å –æ–±—ä–µ–∫—Ç–Ω—ã–º —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–º
3.  **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤:** –ì—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤–º–µ—Å—Ç–µ
4.  **–ò–∑–±–µ–≥–∞–π—Ç–µ –ø–æ–ª–Ω–æ–≥–æ Store:** –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `useStore()` –±–µ–∑ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞
5.  **–ú–µ–º–æ–∏–∑–∏—Ä—É–π—Ç–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã:** –î–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `useMemo` –∏–ª–∏ –≤—ã–Ω–æ—Å–∏—Ç–µ –≤ —Ñ—É–Ω–∫—Ü–∏—é

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

-   **–ë–µ–∑ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤:** Component –ø–æ–≤—Ç–æ—Ä–Ω–æ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ Store (–¥–∞–∂–µ –Ω–µ—Å–≤—è–∑–∞–Ω–Ω–æ–º)
-   **–° —Å–µ–ª–µ–∫—Ç–æ—Ä–∞–º–∏:** Component –ø–æ–≤—Ç–æ—Ä–Ω–æ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
-   **–° useShallow:** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ —Ä–µ–Ω–¥–µ—Ä—ã, –∫–æ–≥–¥–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ –æ–±—ä–µ–∫—Ç –∏–∑–º–µ–Ω—è–µ—Ç—Å—è, –Ω–æ –∑–Ω–∞—á–µ–Ω–∏—è –æ—Å—Ç–∞—é—Ç—Å—è —Ç–µ–º–∏ –∂–µ

**–ü—Ä–∏–º–µ—Ä: –ü—Ä–æ—Å—Ç–æ–π —Å–µ–ª–µ–∫—Ç–æ—Ä –æ–¥–∏–Ω–æ—á–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è**

```typescript
// In AppLayout.tsx - only needs isOpen
const isViewerOpen = useViewerStore((state) => state.isOpen);

// Component only re-renders when isOpen changes
// Ignores changes to controlsVisible, queue, currentIndex, etc.
```

### State Main Process

-   –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —è–≤–ª—è–µ—Ç—Å—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∏—Å—Ç–∏–Ω—ã
-   –°–µ—Ä–≤–∏—Å—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π in-memory State
-   –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–∞–π–º–µ—Ä—ã, –∞ –Ω–µ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π State

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
src/
‚îú‚îÄ‚îÄ main/                          # Electron Main Process
‚îÇ   ‚îú‚îÄ‚îÄ db/                        # Database layer
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repositories/         # Repository pattern implementations
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ artists.repo.ts    # Artists repository
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ posts.repo.ts       # Posts repository
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ db-service.ts          # Legacy database service (deprecated)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ db-worker.ts           # Database worker thread implementation
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ db-worker-client.ts    # Worker client interface
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ migrate.ts             # Migration runner
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schema.ts              # Drizzle ORM schema definitions
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ worker-types.ts        # Worker thread type definitions
‚îÇ   ‚îú‚îÄ‚îÄ ipc/                       # IPC (Inter-Process Communication)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers/           # IPC Controllers (domain-based)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ArtistsController.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PostsController.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SettingsController.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AuthController.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MaintenanceController.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ViewerController.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FileController.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SystemController.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ channels.ts            # IPC channel constants
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts               # IPC setup and registration
‚îÇ   ‚îú‚îÄ‚îÄ core/                      # Core infrastructure
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ di/                    # Dependency Injection
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Container.ts       # DI Container (Singleton)
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Token.ts           # Type-safe DI tokens
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ipc/                    # IPC infrastructure
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ BaseController.ts   # Base controller with error handling
‚îÇ   ‚îú‚îÄ‚îÄ providers/                 # Booru provider implementations
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rule34-provider.ts     # Rule34.xxx provider
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gelbooru-provider.ts   # Gelbooru provider
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types.ts               # Provider interfaces
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts               # Provider registry
‚îÇ   ‚îú‚îÄ‚îÄ services/                  # Background services
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ secure-storage.ts       # Secure storage for API credentials
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sync-service.ts        # Rule34.xxx API synchronization
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ updater-service.ts     # Auto-updater service
‚îÇ   ‚îú‚îÄ‚îÄ lib/                       # Utilities
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ logger.ts             # Logging utility
‚îÇ   ‚îú‚îÄ‚îÄ bridge.ts                  # IPC bridge interface definition
‚îÇ   ‚îú‚îÄ‚îÄ main.d.ts                  # Main process type definitions
‚îÇ   ‚îî‚îÄ‚îÄ main.ts                    # Main process entry point
‚îÇ
‚îú‚îÄ‚îÄ renderer/                      # Electron Renderer Process
‚îÇ   ‚îú‚îÄ‚îÄ components/                # React components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dialogs/               # Dialog components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AddArtistModal.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DeleteArtistDialog.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Onboarding.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UpdateNotification.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gallery/               # Gallery components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ArtistCard.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ArtistGallery.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ PostCard.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inputs/                # Input components
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AsyncAutocomplete.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout/                 # Layout components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AppLayout.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GlobalTopBar.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Sidebar.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/                  # Page components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ArtistDetails.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Browse.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Favorites.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Onboarding.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Settings.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Tracked.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Updates.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ settings/               # Settings components
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ BackupControls.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/                     # shadcn/ui components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ alert.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ button.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ card.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dialog.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dropdown-menu.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ input.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ label.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ select.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ separator.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ viewer/                 # Viewer components
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ViewerDialog.tsx
‚îÇ   ‚îú‚îÄ‚îÄ i18n/                       # Internationalization
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îú‚îÄ‚îÄ lib/                        # Utilities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/                  # Custom React hooks
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useDebounce.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ artist-utils.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tag-utils.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils.ts
‚îÇ   ‚îú‚îÄ‚îÄ locales/                    # Translation files
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ en/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ translation.json
‚îÇ   ‚îú‚îÄ‚îÄ schemas/                    # Form validation schemas
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ form-schemas.ts
‚îÇ   ‚îú‚îÄ‚îÄ store/                       # State management (Zustand)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ viewerStore.ts
‚îÇ   ‚îú‚îÄ‚îÄ App.tsx                     # Main React component
‚îÇ   ‚îú‚îÄ‚îÄ index.css                   # Global styles
‚îÇ   ‚îú‚îÄ‚îÄ index.html                  # HTML template
‚îÇ   ‚îú‚îÄ‚îÄ main.tsx                    # Renderer entry point
‚îÇ   ‚îî‚îÄ‚îÄ renderer.d.ts               # Renderer type definitions
‚îÇ
‚îî‚îÄ‚îÄ preload/                        # Preload scripts (generated by electron-vite)
    ‚îî‚îÄ‚îÄ bridge.cjs                  # Compiled preload script

Root:
‚îú‚îÄ‚îÄ drizzle/                        # Database migrations
‚îÇ   ‚îú‚îÄ‚îÄ meta/                       # Migration metadata
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ _journal.json
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ *_snapshot.json
‚îÇ   ‚îî‚îÄ‚îÄ *.sql                       # SQL migration files
‚îú‚îÄ‚îÄ docs/                           # Documentation
‚îÇ   ‚îú‚îÄ‚îÄ api.md
‚îÇ   ‚îú‚îÄ‚îÄ architecture.md
‚îÇ   ‚îú‚îÄ‚îÄ contributing.md
‚îÇ   ‚îú‚îÄ‚îÄ database.md
‚îÇ   ‚îú‚îÄ‚îÄ development.md
‚îÇ   ‚îú‚îÄ‚îÄ roadmap.md
‚îÇ   ‚îî‚îÄ‚îÄ rule34-api-reference.md
‚îú‚îÄ‚îÄ scripts/                        # Build and utility scripts
‚îÇ   ‚îú‚îÄ‚îÄ ai_reviewer.py
‚îÇ   ‚îî‚îÄ‚îÄ system_prompt.md
‚îú‚îÄ‚îÄ .github/                        # GitHub workflows
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îú‚îÄ‚îÄ ai-review.yml
‚îÇ       ‚îî‚îÄ‚îÄ ci.yml
‚îú‚îÄ‚îÄ electron.vite.config.ts         # Electron-Vite configuration
‚îú‚îÄ‚îÄ drizzle.config.ts               # Drizzle ORM configuration
‚îú‚îÄ‚îÄ tailwind.config.js              # Tailwind CSS configuration
‚îú‚îÄ‚îÄ tsconfig.json                   # TypeScript configuration
‚îî‚îÄ‚îÄ package.json                    # Project dependencies and scripts
```

## –ü—Ä–∏–Ω—Ü–∏–ø—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–Ω—Ü–∏–ø—ã SOLID

-   **–ï–¥–∏–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å (Single Responsibility):** –ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –∏–º–µ–µ—Ç –æ–¥–Ω—É —á–µ—Ç–∫—É—é —Ü–µ–ª—å
-   **–û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å/–ó–∞–∫—Ä—ã—Ç–æ—Å—Ç—å (Open/Closed):** –†–∞—Å—à–∏—Ä—è—Ç—å —á–µ—Ä–µ–∑ –∫–æ–º–ø–æ–∑–∏—Ü–∏—é, –∞ –Ω–µ —á–µ—Ä–µ–∑ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—é
-   **–ò–Ω–≤–µ—Ä—Å–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (Dependency Inversion):** –°–µ—Ä–≤–∏—Å—ã –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π

### KISS –∏ YAGNI

-   **KISS:** –ü—Ä–æ—Å—Ç–æ–π, —á–∏—Ç–∞–µ–º—ã–π –∫–æ–¥ –≤–º–µ—Å—Ç–æ —Ö–∏—Ç—Ä—ã—Ö —Ä–µ—à–µ–Ω–∏–π
-   **YAGNI:** –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ —Å–µ–π—á–∞—Å

### DRY

-   –û–±—â–∏–µ —Ç–∏–ø—ã –º–µ–∂–¥—É Main –∏ Renderer
-   –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ Components –∏ —É—Ç–∏–ª–∏—Ç—ã
-   –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞

## –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

### ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

**–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Å–±–æ—Ä–∫–∞:**

-   **–í–µ—Ä—Å–∏—è Electron:** 39.2.7 —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
-   **–°–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∫–∏:** electron-vite –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–±–æ—Ä–∫–∏
-   **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:** –ü—Ä—è–º–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ `better-sqlite3` —Å —Ä–µ–∂–∏–º–æ–º WAL –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è
-   **–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º (Portable Mode):** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω—ã—Ö –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ö–µ–º–∞:**

-   **–°—Ö–µ–º–∞:** –¢—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (`artists`, `posts`, `settings`) —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Å–≤—è–∑—è–º–∏ –∏ Indexes
-   **–ú–∏–≥—Ä–∞—Ü–∏–∏:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–∏–≥—Ä–∞—Ü–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `drizzle-kit`
-   **Indexes:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ Indexes –ø–æ `artistId`, `isViewed`, `publishedAt`, `isFavorited`, `lastChecked`, `createdAt`
-   **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö Booru —Å –ø–æ–ª–µ–º `provider` (Rule34, Gelbooru)
-   **–¢–∏–ø—ã Artist'–æ–≤:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∏–ø–æ–≤ `tag`, `uploader` –∏ `query`

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å:**

-   **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ:** –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ API –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Electron `safeStorage` API (Windows Credential Manager, macOS Keychain, Linux libsecret)
-   **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ/–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:** –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä—É—á–Ω–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
-   **–ò–∑–æ–ª—è—Ü–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (Context Isolation):** –í–∫–ª—é—á–µ–Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ —Å —Ä–µ–∂–∏–º–æ–º sandbox
-   **CSP:** –°—Ç—Ä–æ–≥–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (Content Security Policy) –≤ production, –æ—Å–ª–∞–±–ª–µ–Ω–Ω–∞—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ HMR)
-   **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ IPC:** IPC-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ —Å `BaseController` –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

**–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:**

-   **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è Tag'–æ–≤:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏–∑ –∏–º–µ–Ω Tag'–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "tag (123)" ‚Üí "tag")
-   **–°–µ—Ä–≤–∏—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç `ON CONFLICT` —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–æ–π upsert
-   **–ü–∞—Ç—Ç–µ—Ä–Ω Provider:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö Booru —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `IBooruProvider`
-   **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏:** –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º–∏ –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏

**UI/UX:**

-   **–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:** 3-—Å–ª–æ–π–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (Preview ‚Üí Sample ‚Üí Original)
-   **–í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è:** `react-virtuoso` –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤
-   **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ–∏—Å–∫–∞:** –ü–æ–∏—Å–∫ –ª–æ–∫–∞–ª—å–Ω—ã—Ö Artist'–æ–≤ –∏ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö Tag'–æ–≤ (–Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤)
-   **–ë–æ–∫–æ–≤–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è:** –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –±–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ —Ä–∞–∑–¥–µ–ª–∞–º–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
-   **–ì–ª–æ–±–∞–ª—å–Ω–∞—è –≤–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å:** –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å –ø–æ–∏—Å–∫–æ–º, —Ñ–∏–ª—å—Ç—Ä–∞–º–∏, —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π (UI —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –±—ç–∫–µ–Ω–¥ –≤ –æ–∂–∏–¥–∞–Ω–∏–∏)
-   **–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π Viewer:** –ò–º–º–µ—Ä—Å–∏–≤–Ω—ã–π Viewer —Å –≥–æ—Ä—è—á–∏–º–∏ –∫–ª–∞–≤–∏—à–∞–º–∏, –∑–∞–≥—Ä—É–∑–∫–æ–π, –∏–∑–±—Ä–∞–Ω–Ω—ã–º
-   **–ú–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–≥—Ä—É–∑–æ–∫:** –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤ –ø–æ–ª–Ω–æ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
-   **–°–∏—Å—Ç–µ–º–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ:** –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –ø–æ–ª–µ–º –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

1.  ‚úÖ **–°–µ—Ä–≤–∏—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:** –í—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ API –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö Booru —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
2.  ‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Settings:** –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö API —Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Electron `safeStorage` API
3.  ‚úÖ **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ Artist'–æ–≤:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ Tag'–∞–º —Å –ø–æ–∏—Å–∫–æ–º —Å –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π Tag'–æ–≤ (–Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤)
4.  ‚úÖ **–ì–∞–ª–µ—Ä–µ—è –ø–æ—Å—Ç–æ–≤:** –°–µ—Ç–∫–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤ —Å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–º –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
5.  ‚úÖ **–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:** 3-—Å–ª–æ–π–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∑–∫–∏ (Preview ‚Üí Sample ‚Üí Original) –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
6.  ‚úÖ **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ Artist'–∞:** –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–µ–≤—å—é –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
7.  ‚úÖ **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ electron-updater
8.  ‚úÖ **–°–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π:** IPC-—Å–æ–±—ã—Ç–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, —Å—Ç–∞—Ç—É—Å–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏
9.  ‚úÖ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:** –ü—Ä—è–º–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ `better-sqlite3` —Å —Ä–µ–∂–∏–º–æ–º WAL –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è
10. ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ:** –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ API –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø–æ–∫–æ—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Electron `safeStorage` API
11. ‚úÖ **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ/–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:** –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä—É—á–Ω–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∏ —Ä–µ–∑–µ—Ä–≤–Ω—ã–º–∏ –∫–æ–ø–∏—è–º–∏ —Å –æ—Ç–º–µ—Ç–∫–∞–º–∏ –≤—Ä–µ–º–µ–Ω–∏
12. ‚úÖ **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ–∏—Å–∫–∞:** –ü–æ–∏—Å–∫ –ª–æ–∫–∞–ª—å–Ω—ã—Ö Artist'–æ–≤ –∏ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö Tag'–æ–≤ —á–µ—Ä–µ–∑ API –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è Booru (–Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤)
13. ‚úÖ **–û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω–æ–µ:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–º–µ—á–∞—Ç—å –ø–æ—Å—Ç—ã –∫–∞–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ –¥–ª—è –ª—É—á—à–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
14. ‚úÖ **–°–∏—Å—Ç–µ–º–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ:** –û—Ç–º–µ—Ç–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–±—Ä–∞–Ω–Ω—ã–º–∏ –ø–æ—Å—Ç–∞–º–∏ —Å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
15. ‚úÖ **–ú–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–≥—Ä—É–∑–æ–∫:** –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤ –ø–æ–ª–Ω–æ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
16. ‚úÖ **–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π Viewer:** –ò–º–º–µ—Ä—Å–∏–≤–Ω—ã–π Viewer —Å –≥–æ—Ä—è—á–∏–º–∏ –∫–ª–∞–≤–∏—à–∞–º–∏, –∑–∞–≥—Ä—É–∑–∫–æ–π, –∏–∑–±—Ä–∞–Ω–Ω—ã–º –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º Tag'–∞–º–∏
17. ‚úÖ **–ë–æ–∫–æ–≤–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è:** –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –±–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ —Ä–∞–∑–¥–µ–ª–∞–º–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ (Updates, Browse, Favorites, Tracked, Settings)
18. ‚úÖ **–ì–ª–æ–±–∞–ª—å–Ω–∞—è –≤–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å:** –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å –ø–æ–∏—Å–∫–æ–º, —Ñ–∏–ª—å—Ç—Ä–∞–º–∏, —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π (UI —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –±—ç–∫–µ–Ω–¥-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ –æ–∂–∏–¥–∞–Ω–∏–∏)
19. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö API –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∏ –≤–æ –≤—Ä–µ–º—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
20. ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±—É—Ñ–µ—Ä–æ–º –æ–±–º–µ–Ω–∞:** –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
21. ‚úÖ **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤—ã—Ö–æ–¥–∞ –∏–∑ —Å–∏—Å—Ç–µ–º—ã:** –û—á–∏—Å—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –≤–æ–∑–≤—Ä–∞—Ç –∫ Onboarding
22. ‚úÖ **–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω—ã—Ö –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤
23. ‚úÖ **IPC-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã:** –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ —Å `BaseController` –∏ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
24. ‚úÖ **–ü–∞—Ç—Ç–µ—Ä–Ω Provider:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö Booru —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `IBooruProvider` (Rule34, Gelbooru)

## –ê–∫—Ç–∏–≤–Ω–∞—è –¥–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏)

### –ê. –§–∏–ª—å—Ç—Ä—ã (–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫) üöß UI –≥–æ—Ç–æ–≤, –±—ç–∫–µ–Ω–¥ –≤ –æ–∂–∏–¥–∞–Ω–∏–∏

**–¶–µ–ª—å:** –ü–æ–∑–≤–æ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —É—Ç–æ—á–Ω—è—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≥–∞–ª–µ—Ä–µ–∏.

-   ‚úÖ **UI –≥–ª–æ–±–∞–ª—å–Ω–æ–π –≤–µ—Ä—Ö–Ω–µ–π –ø–∞–Ω–µ–ª–∏:** –ü–∞–Ω–µ–ª—å –ø–æ–∏—Å–∫–∞, –∫–Ω–æ–ø–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞, –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤–∏–¥–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ `GlobalTopBar.tsx`
-   ‚è≥ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ **–†–µ–π—Ç–∏–Ω–≥—É** (Safe, Questionable, Explicit) - UI –≥–æ—Ç–æ–≤, –±—ç–∫–µ–Ω–¥-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ –æ–∂–∏–¥–∞–Ω–∏–∏
-   ‚è≥ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ **–¢–∏–ø—É –º–µ–¥–∏–∞** (–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ vs –í–∏–¥–µ–æ) - UI –≥–æ—Ç–æ–≤, –±—ç–∫–µ–Ω–¥-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ –æ–∂–∏–¥–∞–Ω–∏–∏
-   ‚è≥ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ **Tag'–∞–º** (–õ–æ–∫–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ —Å—Ä–µ–¥–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤) - UI –≥–æ—Ç–æ–≤, –±—ç–∫–µ–Ω–¥-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ –æ–∂–∏–¥–∞–Ω–∏–∏
-   ‚è≥ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ: –î–∞—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (–ù–æ–≤—ã–µ/–°—Ç–∞—Ä—ã–µ), –î–∞—Ç–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ - UI –≥–æ—Ç–æ–≤, –±—ç–∫–µ–Ω–¥-—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤ –æ–∂–∏–¥–∞–Ω–∏–∏

**–°—Ç–∞—Ç—É—Å:** UI –≥–ª–æ–±–∞–ª—å–Ω–æ–π –≤–µ—Ä—Ö–Ω–µ–π –ø–∞–Ω–µ–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –≤–∏–¥–µ–Ω –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏. –õ–æ–≥–∏–∫–∞ –±—ç–∫–µ–Ω–¥-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è UI —á–µ—Ä–µ–∑ IPC-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ —Å Component'–æ–º `ArtistGallery`.

### –ë. –ú–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–≥—Ä—É–∑–æ–∫ ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏)

**–¶–µ–ª—å:** –ü–æ–∑–≤–æ–ª–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ñ–∞–π–ª—ã –≤ –ø–æ–ª–Ω–æ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ –≤ –ª–æ–∫–∞–ª—å–Ω—É—é —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É.

-   ‚úÖ –ö–Ω–æ–ø–∫–∞ "Download Original" –Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ Post'–∞ (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ ViewerDialog)
-   ‚úÖ **–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–≥—Ä—É–∑–∫–∏:** –ó–∞–≥—Ä—É–∑–∫–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ Main Process —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
-   ‚úÖ **–°–æ–±—ã—Ç–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:** –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ IPC-—Å–æ–±—ã—Ç–∏—è (`onDownloadProgress`)
-   ‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞–º–∏:** –û—Ç–∫—Ä—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –≤ –ø–∞–ø–∫–µ (`openFileInFolder`)
-   ‚è≥ "Download All" –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞/Artist'–∞ (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
-   ‚è≥ **Settings:** –†–∞–∑—Ä–µ—à–∏—Ç—å –≤—ã–±–æ—Ä –ø–∞–ø–∫–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞. –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∞. –ü–∞–∫–µ—Ç–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞–ø–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–ª–∞–Ω–∏—Ä—É—é—Ç—Å—è –¥–ª—è –±—É–¥—É—â–∏—Ö –≤—ã–ø—É—Å–∫–æ–≤.

### –í. –ü–ª–µ–π–ª–∏—Å—Ç—ã / –ö–æ–ª–ª–µ–∫—Ü–∏–∏ ‚è≥ –ù–µ –Ω–∞—á–∞—Ç–æ

**–¶–µ–ª—å:** –°–æ–∑–¥–∞–Ω–∏–µ –∫—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π –ø–æ—Å—Ç–æ–≤ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç Artist'–æ–≤/–¢—Ä–µ–∫–µ—Ä–æ–≤.

**–§–∞–∑–∞ 1: MVP**

-   –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `playlists` (`id`, `name`, `created_at`)
-   –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `playlist_posts` (`playlist_id`, `post_id`, `added_at`)
-   –ö–Ω–æ–ø–∫–∞ "‚≠ê Add to playlist" –Ω–∞ Post Card
-   –ù–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞/–≤–∫–ª–∞–¥–∫–∞: "Playlists"
-   –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–ª–µ–π–ª–∏—Å—Ç–∞: –°–µ—Ç–∫–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π

**–°—Ç–∞—Ç—É—Å:** –í —Å—Ö–µ–º–µ –Ω–µ—Ç —Ç–∞–±–ª–∏—Ü –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤, –∫–æ–¥, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –ø–ª–µ–π–ª–∏—Å—Ç–∞–º–∏, –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω.

### üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å (–£–∫—Ä–µ–ø–ª–µ–Ω–∏–µ)

–°–º. [–î–æ—Ä–æ–∂–Ω—É—é –∫–∞—Ä—Ç—É](./roadmap.md#-security--reliability-hardening) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω—ã—Ö —É–ª—É—á—à–µ–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

-   ‚úÖ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** - ‚úÖ **–ó–ê–í–ï–†–®–ï–ù–û:** –ü—Ä—è–º–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ `better-sqlite3` —Å —Ä–µ–∂–∏–º–æ–º WAL –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è
-   ‚úÖ **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ / –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö API** - ‚úÖ **–ó–ê–í–ï–†–®–ï–ù–û:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Electron `safeStorage` API –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
-   ‚úÖ **–°–∏—Å—Ç–µ–º–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è / –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** - ‚úÖ **–ó–ê–í–ï–†–®–ï–ù–û:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä—É—á–Ω–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏

### –ë—É–¥—É—â–∏–µ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è

1.  **–ü–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ Tag'–∏:** –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ Tag'–æ–≤ (—Å—Ö–µ–º–∞ –≥–æ—Ç–æ–≤–∞)
2.  **–ò–Ω—ä–µ–∫—Ü–∏—è Content Script:** –£–ª—É—á—à–µ–Ω–∏—è DOM –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å–∞–π—Ç–æ–≤
3.  **–ü–∞–Ω–µ–ª—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:** –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–º Artist'–∞–º –∏ –ø–æ—Å—Ç–∞–º
4.  **–î–≤—É—Ö–º–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:** –†–µ–∂–∏–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (–ª–æ–∫–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö) –∏ —Ä–µ–∂–∏–º –±—Ä–∞—É–∑–µ—Ä–∞ (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π webview)
5.  **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö Booru:** –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ Provider –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö Booru-–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

### –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

-   –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç—ã—Å—è—á–∏ Artist'–æ–≤ –∏ –ø–æ—Å—Ç–æ–≤
-   –û–ø—Ä–æ—Å –º–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –ø–∞–∫–µ—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
-   UI –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤
-   –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è Provider –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ Booru-–∏—Å—Ç–æ—á–Ω–∏–∫–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π —è–¥—Ä–∞

## –°–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

1.  **–ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:** –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ Indexes –ø–æ —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–º –ø–æ–ª—è–º
2.  **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤:** –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã Drizzle
3.  **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è React:** –ú–µ–º–æ–∏–∑–∞—Ü–∏—è —Ç–∞–º, –≥–¥–µ —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
4.  **–õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (Lazy Loading):** –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–æ–¥–∞ –¥–ª—è –±–æ–ª—å—à–∏—Ö Components

## –°—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

1.  **–ë—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–∞–∑ (Fail Fast):** –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ö
2.  **–û–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏:** –ß–µ—Ç–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
3.  **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫:** –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `electron-log`
4.  **–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º:** –û—à–∏–±–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ UI

## –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞—É–¥–∏—Ç)

–û—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –≤—Å–µ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–º —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º –∞—É–¥–∏—Ç–µ, –≤–æ—Ç —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–ª—é—á–µ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:

### ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

-   **–í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è:** `react-virtuoso` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤ (`ArtistGallery.tsx`)
-   **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–∏–¥–µ–æ:** –§–æ—Ä–º–∞—Ç—ã `.mp4` –∏ `.webm` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ `<video>`
-   **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:** Zod-–≤–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ IPC-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
-   **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** –ë–ª–æ–∫–∏ try-catch –≤ IPC-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –æ—à–∏–±–æ–∫

### ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

-   **Developer HMR:** Renderer Process –∏–º–µ–µ—Ç –ø–æ–ª–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É HMR. Main Process —Ç—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–≥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ (–±–µ–∑ –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö —Ñ–∞–π–ª–æ–≤)
-   **–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:** Zod-–≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ (–¥–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è), –Ω–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π —É—Ç–∏–ª–∏—Ç—ã
-   **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** IPC-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–º–µ—é—Ç –±–ª–æ–∫–∏ try-catch, –Ω–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤–º–µ—Å—Ç–æ —É–¥–æ–±–Ω—ã—Ö –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π
-   **–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –≤–∏–¥–µ–æ:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –Ω–µ—Ç —è–≤–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ —É—Å–∫–æ—Ä–µ–Ω–∏—è –≤ `webPreferences`

### ‚è≥ –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç / –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ

-   **Safe Mode / NSFW Filter:** –ù–µ—Ç –ª–æ–≥–∏–∫–∏ —Ä–∞–∑–º—ã—Ç–∏—è –∏–ª–∏ —Ñ–ª–∞–≥–∞ `safeMode` –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö/Settings
-   **–í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (Age Gate):** –¢–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç –¥–∏—Å–∫–ª–µ–π–º–µ—Ä–∞ –≤ README, –Ω–µ—Ç –æ–≤–µ—Ä–ª–µ—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–ª–∏ —Ñ–ª–∞–≥–∞ `isAdult`
-   **–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏ —á–µ—Ä–µ–∑ `app.getPath("userData")`, –Ω–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π
-   **–ú–µ—Ä—ã –ø–æ –±–æ—Ä—å–±–µ —Å –±–æ—Ç–∞–º–∏:** –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–æ–∫–∏ User-Agent, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ (1.5—Å/0.5—Å), –Ω–æ –±–µ–∑ —Ä–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ —Ä–æ—Ç–∞—Ü–∏–∏
-   **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ë–î (FTS5):** –¢–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ Indexes, –Ω–µ—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü FTS5 –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ Tag'–∞–º
-   **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è:** –ù–µ—Ç –æ–±—â–µ–π —É—Ç–∏–ª–∏—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (`src/main/lib/validation.ts`)

–°–º. [–î–æ—Ä–æ–∂–Ω—É—é –∫–∞—Ä—Ç—É](./roadmap.md#-technical-improvements-from-audit) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.